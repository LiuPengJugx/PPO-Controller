import time
import torch
from stable_baselines3 import PPO
import numpy as np
from controller.db.workload import Workload
from controller.environment.env_v2 import Env2
from controller.environment.env_v2_skew import EnvSkew2
from controller.environment.env_v2_2600 import Env2600
from controller.environment.env_v2_mask import EnvMask
from controller.environment.env_v2_mask_new import EnvMaskNew
from controller.environment.env_v2_par_mask import EnvParMask
from controller.environment.env_v2_2600_speedup import Env2600Speedup
from controller.environment.env_v2_state import EnvState
from controller.environment.env_v2_mask_curve import EnvMaskCurve
from controller.environment.env_v2_classifier import EnvWithClassifier
from controller.environment.env_v4 import Env4
from pretrained.workload_predictor import WorkloadClassifier
import multiprocessing as mul
from controller.par_algorithm.MyThread import MyThread
class PpoController:
    action_list=dict()

    @staticmethod
    def train_ppo_model(env,reward_threshold,saved_model_path,queue):
        env.reward_threshold = reward_threshold
        # model = PPO("MlpPolicy", env, verbose=1,device='cuda:4',tensorboard_log="./ppo_controller_tensorboard_env2/env4/")
        # # Run Command: tensorboard --logdir ./ppo_controller_tensorboard_env2/env4/  --bind
        # model.learn(total_timesteps=2e5)
        # model.save(saved_model_path)
        # del model
        results = dict()
        model = PPO.load(saved_model_path,device='cuda:4')
        obs = env.reset()
        epoch = 0
        total_reward = []
        # 记录奖励为正的比例
        total_actions = 0
        good_actions = 0
        reward_list = []
        for i in range(5000):
            action, _states = model.predict(obs, deterministic=True)
            obs, reward, done, info = env.step(action)
            reward_list.append(reward)
            if reward != 0: total_actions += 1
            if reward > 0: good_actions += 1
            total_reward.append(reward)
            if done:
                result = {
                          'reward': sum(total_reward),
                          'avg_cost': sum(env.io_cost) / sum([sql['feature'].frequency for sql in env.w.sql_list]),
                          'action_ratio': [len(env.action_list.keys()), round(good_actions / total_actions, 3)],
                          'rep_cost': sum(env.rep_cost) / sum([sql['feature'].frequency for sql in env.w.sql_list])}
                results[reward_threshold]=result
                print(f"The total reward : {result['reward']}")
                print(env.cost_time_map['cost'])
                print(env.cost_time_map['cdf'])
                print('action list : ', env.action_list.keys())
                print(f"Average query cost: {result['avg_cost']}")
                print(f"Average repartition cost: {result['rep_cost']}")
                print(reward_list)
                epoch += 1
                obs = env.reset()
                if epoch == 1: break
        print(results)
        env.close()
        queue.put(results)

    @staticmethod
    def train_model_diff_reward_threshold(wLoad):
        reward_threshold_list=np.linspace(0.05,0.2,7)
        queue = mul.Queue()
        jobs = []
        # torch.multiprocessing.set_start_method('spawn')
        # ctx = mul.get_context("spawn")

        chunk_result=list()
        for reward_threshold in reward_threshold_list:
            reward_threshold=round(reward_threshold,3)
            env = Env4(wLoad)
            process = mul.Process(target=PpoController.train_ppo_model, args=(env,reward_threshold,"stable_pretrained_model/ppo_controller_v4_2800_"+str(reward_threshold),queue))
            process.start()
            jobs.append(process)
        for idx,_ in enumerate(jobs):
            chunk_result.append(queue.get())
        # for process in jobs: process.join()
        print(chunk_result)
    # ENV-MASK 5e4
    # {0: [{'reward': 19.3995236345659, 'avg_cost': 352.90716189553115}],   0.05
    #  1: [{'reward': 20.14576704070486, 'avg_cost': 357.55844785212366}],
    #  2: [{'reward': 16.243991450266673, 'avg_cost': 356.3261102841912}],
    #  3: [{'reward': 17.375958753271036, 'avg_cost': 367.72155491709646}],
    #  4: [{'reward': 12.902817836046264, 'avg_cost': 366.117380317768}],
    #  5: [{'reward': 15.955132572416616, 'avg_cost': 369.739554847866}],
    #  6: [{'reward': 16.710481931576798, 'avg_cost': 379.1565647824431}],
    #  7: [{'reward': 19.78887987204151, 'avg_cost': 374.60074768943196}]}

    # ENV-MASK 7e4
    # {0.05: [{'reward': 23.14980539662517, 'avg_cost': 357.5984976980858}],
    #  0.07500000000000001: [{'reward': 21.98387226196716, 'avg_cost': 357.0407767662432}],
    #  0.1: [{'reward': 18.670401458223147, 'avg_cost': 359.28249506732664}],
    #  0.125: [{'reward': 17.292929704634687, 'avg_cost': 353.7374087022742}],
    #  0.15000000000000002: [{'reward': 16.058873474634538, 'avg_cost': 349.06383052372877}],
    #  0.17500000000000004: [{'reward': 15.10050512230219, 'avg_cost': 358.08522274914327}],
    #  0.2: [{'reward': 16.367051455992307, 'avg_cost': 355.10716881858144}]}

    # 1300
    # {0.05: [{'reward': 17.203203206088713, 'avg_cost': 424.1025513467415}],
    #  0.07500000000000001: [{'reward': 4.303690942785271, 'avg_cost': 424.34432520787436}],
    #  0.1: [{'reward': 1.0860642793946864, 'avg_cost': 421.8261672944354}],
    #  0.125: [{'reward': -2.472714895188576, 'avg_cost': 423.4357188543814}],
    #  0.15000000000000002: [{'reward': 7.603659372300443, 'avg_cost': 418.071849904058}],
    #  0.17500000000000004: [{'reward': -4.390639229559201, 'avg_cost': 426.2825669817355}],
    #  0.2: [{'reward': 10.763970635840122, 'avg_cost': 429.0972923033189}]}

    # ENV-MASK-CURVE
    # {0.05: [{'reward': 24.380812571998987, 'avg_cost': 356.7552355567863}],
    #  0.1: [{'reward': 22.791591658146565, 'avg_cost': 352.6265706670359}],  0.1
    #  0.15: [{'reward': 20.17534079661996, 'avg_cost': 355.7318010315345}],
    #  0.2: [{'reward': 16.439277887468336, 'avg_cost': 346.26387206203054}],  0.2
    #  0.25: [{'reward': 20.436372596666764, 'avg_cost': 369.24947211741494}],
    #  0.3: [{'reward': 21.497969893865577, 'avg_cost': 385.71743570217035}],
    #  0.35: [{'reward': 27.014314143791466, 'avg_cost': 376.49814808404585}],
    #  0.4: [{'reward': 28.29824078231645, 'avg_cost': 374.45342517913394}]}

    def repartition2(self,initial_par, wLoad, **kwargs):
        env = Env2()
        env.reward_threshold = 0.1
        # pretrained = PPO("MlpPolicy", env, verbose=1)
        # # pretrained = PPO("MlpPolicy", env, verbose=1,tensorboard_log="./ppo_controller_tensorboard_env2/")
        # # Run Command: tensorboard --logdir ./ppo_controller_tensorboard_env2/
        # pretrained.learn(total_timesteps=2e4)
        # pretrained.save("stable_pretrained_model/ppo_controller_v2_1500")
        # del pretrained
        model = PPO.load("stable_pretrained_model/ppo_controller_v2_1500")
        # pretrained = PPO.load("stable_pretrained_model/ppo_controller_v2_skew")
        obs = env.reset()
        epoch = 0
        total_reward = []
        for i in range(1000):
            action, _states = model.predict(obs, deterministic=True)
            obs, reward, done, info = env.step(action)
            total_reward.append(reward)
            if done:
                result = {'reward': sum(total_reward),
                          'avg_cost': sum(env.io_cost) / sum([sql['feature'].frequency for sql in env.w.sql_list])}
                print(f"The total reward : {result['reward']}")
                print('io_cost : ', env.io_cost)
                print('action list : ', env.action_list)
                self.action_list=env.action_list
                print(f"Average query cost: {result['avg_cost']}")
                epoch += 1
                obs = env.reset()
                if epoch == 1: break
        env.close()
    def repartition3(self,initial_par, wLoad, **kwargs):
        env = EnvSkew2()
        env.reward_threshold = 0.1
        # pretrained = PPO("MlpPolicy", env, verbose=1)
        # # pretrained = PPO("MlpPolicy", env, verbose=1,tensorboard_log="./ppo_controller_tensorboard_env2/")
        # # Run Command: tensorboard --logdir ./ppo_controller_tensorboard_env2/ --bind_all
        # pretrained.learn(total_timesteps=2e4)
        # pretrained.save("stable_pretrained_model/ppo_controller_v2_1500")
        # del pretrained
        # pretrained = PPO.load("stable_pretrained_model/ppo_controller_v2_1500")
        model = PPO.load("stable_pretrained_model/ppo_controller_v2_skew")
        obs = env.reset()
        epoch = 0
        total_reward = []
        for i in range(1000):
            action, _states = model.predict(obs, deterministic=True)
            obs, reward, done, info = env.step(action)
            total_reward.append(reward)
            if done:
                result = {'reward': sum(total_reward),
                          'avg_cost': sum(env.io_cost) / sum([sql['feature'].frequency for sql in env.w.sql_list])}
                print(f"The total reward : {result['reward']}")
                print('io_cost : ', env.io_cost)
                print('action list : ', env.action_list)
                self.action_list=env.action_list
                print(f"Average query cost: {result['avg_cost']}")
                epoch += 1
                obs = env.reset()
                if epoch == 1: break
        env.close()

    def repartition1(self, initial_par, wLoad, **kwargs):
        for i in range(10000):
            # time.sleep(2)
            print(i)
        return 'over'

    def repartition(self,initial_par, wLoad, **kwargs):
        # env = EnvSkew4000(wLoad)
        # env = EnvWithClassifier(wLoad)
        # env.reward_threshold = 0.1
        # pretrained = PPO("MlpPolicy", env, verbose=1,tensorboard_log="./ppo_controller_tensorboard_env2/")
        # pretrained.learn(total_timesteps=5e4)
        # pretrained.save("stable_pretrained_model/ppo_controller_v2_4000_copy")
        # Run Command: tensorboard --logdir ./ppo_controller_tensorboard_env2/ --bind_all
        # del pretrained
        # env = Env2600(wLoad)
        # env = EnvMaskCurve(wLoad)
        # env = EnvMask(wLoad)
        # env = EnvMaskNew(wLoad)
        env = Env4(wLoad)
        # env = EnvParMask(wLoad)
        # env = EnvState(wLoad)
        # env = Env2600Speedup(wLoad)
        env.reward_threshold = 0.1
        # pretrained = PPO("MlpPolicy", env, verbose=1,tensorboard_log="./ppo_controller_tensorboard_env2/env_mask_new")
        # pretrained.learn(total_timesteps=1e4)
        # # Run Command: tensorboard --logdir ./ppo_controller_tensorboard_env2/
        # # pretrained.save("stable_pretrained_model/ppo_controller_v2_2600")
        # # pretrained.save("stable_pretrained_model/ppo_controller_v2_2600_state")
        # pretrained.save("stable_pretrained_model/ppo_controller_v2_2600_speedup")
        # pretrained.save("stable_pretrained_model/ppo_controller_v2_2600_mask")
        # pretrained.save("stable_pretrained_model/ppo_controller_v2_2600_par_mask")
        # del pretrained
        # model = PPO.load("stable_pretrained_model/ppo_controller_v4_2800_0.05",device='cuda:4')
        model = PPO.load("stable_pretrained_model/ppo_controller_v4_2800_best",device='cuda:4')
        # model = PPO.load("stable_pretrained_model/ppo_controller_v2_2600_0.05",device='cuda:4')
        # model = PPO.load("stable_pretrained_model/ppo_controller_v2_2600_state")
        # model = PPO.load("stable_pretrained_model/ppo_controller_v2_2600_mask",device='cuda:4')
        # model = PPO.load("stable_pretrained_model/ppo_controller_v2_2600_par_mask_0.05")
        # model = PPO.load("stable_pretrained_model/ppo_controller_v2_2600_curve_0.05")
        # model=pretrained
        obs = env.reset()
        epoch = 0
        total_reward = []
        # 记录奖励为正的比例
        total_actions=0
        good_actions=0
        reward_list=[]
        result=dict()
        for i in range(5000):
            action, _states = model.predict(obs, deterministic=True)
            obs, reward, done, info = env.step(action)
            reward_list.append(reward)
            if reward!=0:total_actions+=1
            if reward>0:good_actions+=1
            total_reward.append(reward)
            if done:
                result = {'reward': sum(total_reward),
                          'avg_cost': sum(env.io_cost) / sum([sql['feature'].frequency for sql in env.w.sql_list]),
                          'action_ratio':[len(env.action_list.keys()),round(good_actions/total_actions,3),total_actions],
                          'rep_cost':sum(env.rep_cost)/sum([sql['feature'].frequency for sql in env.w.sql_list])}
                          # 'optimize_time':env.optimize_time}
                print(f"The total reward : {result['reward']}")
                print(env.cost_time_map['cost'])
                print(env.cost_time_map['cdf'])
                print('action list : ', env.action_list.keys())
                self.action_list = env.action_list
                print(f"Average query cost: {result['avg_cost']}")
                print(f"Average repartition cost: {result['rep_cost']}")
                # print(f"Optimize Time : {env.optimize_time}")
                print(reward_list)
                epoch += 1
                if epoch == 1: break
        env.close()
        return result


if __name__=="__main__":
    torch.multiprocessing.set_start_method('spawn')
    ppo=PpoController()
    test_result=dict()
    task_list=[]
    # for w_path in [1500,3000,10000,12000,4000,5000,1300]:
    workload_dict = {
        'data1': [1500],
        # 'data1': [1500, 3000, 1300, 4000],
        # 'data2': [1200, 1350],
        # 'data3': [1600, 2600]
    }
    for w_path in workload_dict.keys():
        for query_num in workload_dict[w_path]:
            wLoad = Workload(50, f'data/{w_path}/{query_num}query-steam.csv')
            # ppo.train_model_diff_reward_threshold(wLoad)
            task=MyThread(ppo.repartition,(None, wLoad))
            task.start()
            task_list.append(task)
    for i,task in enumerate(task_list):
        test_result[i]=task.get_result()
    print(test_result)

# env-mask 0.05
# {1500: {'reward': 1.0460223286109176, 'avg_cost': 245.68503984544796, 'action_ratio': 0.6752577319587629, 'optimize_time': 46.998993158340454},
#  3000: {'reward': 4.435759826406718, 'avg_cost': 246.3293279928794, 'action_ratio': 0.6821428571428572, 'optimize_time': 57.293803691864014},
#  10000: {'reward': 20.710004624175806, 'avg_cost': 282.83270828346235, 'action_ratio': 0.832271762208068, 'optimize_time': 173.1530601978302},
#  12000: {'reward': 166.6710771292839, 'avg_cost': 446.12870784082247, 'action_ratio': 0.8592411260709915, 'optimize_time': 391.0474388599396},
#  2600: {'reward': 19.3995236345659, 'avg_cost': 352.8395929246426, 'action_ratio': 0.975609756097561, 'optimize_time': 41.089038133621216},
#  4000: {'reward': 47.68056811070806, 'avg_cost': 442.7442307692308, 'action_ratio': 0.8782201405152225, 'optimize_time': 128.5898678302765},
#  5000: {'reward': 52.84104341658582, 'avg_cost': 443.30194706146256, 'action_ratio': 0.9237875288683602, 'optimize_time': 169.22802090644836},
#  1300: {'reward': 6.322102319050445, 'avg_cost': 441.84372112856227, 'action_ratio': 0.9401709401709402, 'optimize_time': 39.00603890419006}}

# ENV-MASK 0.15
# {0: {'reward': 5.295808676592268, 'avg_cost': 251.68196087901472, 'action_ratio': [9, 0.738], 'action_num': 233},
#  1: {'reward': 1.6770012273645072, 'avg_cost': 248.2779409583148, 'action_ratio': [9, 0.78], 'action_num': 305},
#  2: {'reward': 16.386982579779932, 'avg_cost': 282.67335159720193, 'action_ratio': [41, 0.895], 'action_num': 1397},
#  3: {'reward': 100.08542358239534, 'avg_cost': 434.9534661306953, 'action_ratio': [390, 0.899], 'action_num': 1629},
#  4: {'reward': 16.058873474634538, 'avg_cost': 349.06383052372877, 'action_ratio': [46, 0.94], 'action_num': 217},
#  5: {'reward': 26.53933506339599, 'avg_cost': 427.5208407871199, 'action_ratio': [108, 0.913], 'action_num': 426},
#  6: {'reward': 23.689608831956292, 'avg_cost': 432.0775953342306, 'action_ratio': [117, 0.922], 'action_num': 423},
#  7: {'reward': 7.603659372300443, 'avg_cost': 422.9567905621491, 'action_ratio': [22, 0.895], 'action_num': 124}}

# ENV-MASK 0.15(不考虑重分区成本)
# {0: {'reward': 5.295808676592268, 'avg_cost': 250.81840135233037, 'action_ratio': [9, 0.738], 'action_num': 233},   258.31     252.0
#  1: {'reward': 1.6770012273645072, 'avg_cost': 247.80228452751817, 'action_ratio': [9, 0.78], 'action_num': 305},    252.27     248.6
#  2: {'reward': 16.386982579779932, 'avg_cost': 282.16352368540043, 'action_ratio': [41, 0.895], 'action_num': 1397},  273.11   284.43
#  3: {'reward': 100.08079824682098, 'avg_cost': 426.67456178364887, 'action_ratio': [390, 0.899], 'action_num': 1629},   429.76   427.36
#  4: {'reward': 16.058873474634538, 'avg_cost': 344.7936931011804, 'action_ratio': [46, 0.94], 'action_num': 217},   346.63   352.84
#  5: {'reward': 26.53933506339599, 'avg_cost': 420.15339892665475, 'action_ratio': [108, 0.913], 'action_num': 426},   421.09  421.42
#  6: {'reward': 23.692088318015273, 'avg_cost': 425.5176491700314, 'action_ratio': [117, 0.922], 'action_num': 423},  420.13   426.99
#  7: {'reward': 7.603659372300443, 'avg_cost': 418.071849904058, 'action_ratio': [22, 0.895], 'action_num': 124}}  427.46   426.1
#
#  248
#  250
# {0: {'reward': 13.206236360782354, 'avg_cost': 279.37452456313, 'action_ratio': [38, 0.83], 'action_num': 1443},
#  1: {'reward': 115.85434563851041, 'avg_cost': 426.09912730315756, 'action_ratio': [444, 0.892], 'action_num': 1623}}
# {0: {'reward': 16.10386931745131, 'avg_cost': 345.9361002457683, 'action_ratio': [42, 0.952], 'action_num': 207},
#  1: {'reward': 29.592562723798025, 'avg_cost': 422.37745974955277, 'action_ratio': [117, 0.913], 'action_num': 425},
#  2: {'reward': 29.17294805026831, 'avg_cost': 425.5462000897263, 'action_ratio': [131, 0.924], 'action_num': 433},
#  3: {'reward': 7.976140629262272, 'avg_cost': 418.1454054438206, 'action_ratio': [25, 0.886], 'action_num': 123}}




# ENV-MASK 0.05(不考虑重分区成本)
# {0: {'reward': 1.072414044730295, 'avg_cost': 254.392236174837, 'action_ratio': [3, 1.0], 'action_num': 4},
#  1: {'reward': -0.30101246001706417, 'avg_cost': 241.63290313009938, 'action_ratio': [22, 0.6], 'action_num': 195},
#  2: {'reward': 15.102558308561338, 'avg_cost': 274.6232855458326, 'action_ratio': [114, 0.872], 'action_num': 663},
#  3: {'reward': 144.57957291844767, 'avg_cost': 424.49117589922145, 'action_ratio': [936, 0.846], 'action_num': 1570}, 4
#  : {'reward': 23.14980539662517, 'avg_cost': 348.6528090276576, 'action_ratio': [115, 0.982], 'action_num': 164},
#  5: {'reward': 47.675215146831526, 'avg_cost': 428.79881484794277, 'action_ratio': [250, 0.887], 'action_num': 406},
#  6: {'reward': 48.83473914356795, 'avg_cost': 427.80708838043967, 'action_ratio': [284, 0.902], 'action_num': 420},
#  7: {'reward': 17.203203206088713, 'avg_cost': 424.1025513467415, 'action_ratio': [79, 0.944], 'action_num': 108}}

#  ENV-MASK 0.1 (不考虑重分区成本)
# {0: {'reward': 6.351935322901814, 'avg_cost': 253.645798116397, 'action_ratio': [19, 0.697], 'action_num': 264},
#  1: {'reward': 5.810218237399846, 'avg_cost': 242.56513870345646, 'action_ratio': [16, 0.844], 'action_num': 244},
#  2: {'reward': 12.073528962114226, 'avg_cost': 284.19798565488384, 'action_ratio': [122, 0.854], 'action_num': 1407},
#  3: {'reward': 142.74076361549632, 'avg_cost': 426.3420777357701, 'action_ratio': [670, 0.914], 'action_num': 1587},
#  4: {'reward': 18.660218649977327, 'avg_cost': 352.872304337291, 'action_ratio': [75, 0.943], 'action_num': 211},
#  5: {'reward': 26.32603062642121, 'avg_cost': 422.2832960644007, 'action_ratio': [155, 0.877], 'action_num': 414},
#  6: {'reward': 39.01860761347113, 'avg_cost': 427.2252669358457, 'action_ratio': [212, 0.949], 'action_num': 410},
#  7: {'reward': -2.472714895188576, 'avg_cost': 423.4357188543814, 'action_ratio': [49, 0.924], 'action_num': 119}}

# ENV-MASK 0.1
# {0: {'reward': 1.9013045757187745, 'avg_cost': 247.38951943974885, 'action_ratio': 0.9146341463414634},
#  1: {'reward': 1.5736213465209148, 'avg_cost': 254.86058448301438, 'action_ratio': 0.7745098039215687},
#  2: {'reward': 6.387383026938474, 'avg_cost': 313.43966273904834, 'action_ratio': 0.9047619047619048},
#  3: {'reward': 164.9096172273478, 'avg_cost': 439.6628162405296, 'action_ratio': 0.9166163141993958},
#  4: {'reward': 18.656649614122642, 'avg_cost': 351.96150784035444, 'action_ratio': 0.9466666666666667},
#  5: {'reward': 34.29978353132185, 'avg_cost': 437.975, 'action_ratio': 0.8720379146919431},
#  6: {'reward': 38.074758859833615, 'avg_cost': 439.0065141318977, 'action_ratio': 0.9302884615384616},
#  7: {'reward': 3.776399879744378, 'avg_cost': 438.90107312913085, 'action_ratio': 0.925}}


# ENV-2600-CURVE 0.1
# {0: {'reward': 3.3972145253733212, 'avg_cost': 249.0186549142719, 'action_ratio': 0.6981981981981982},
#  1: {'reward': 10.40816744810284, 'avg_cost': 246.92505562972852, 'action_ratio': 0.8601398601398601},
#  2: {'reward': 11.208066189118323, 'avg_cost': 275.9640219521061, 'action_ratio': 0.860128617363344},
#  3: {'reward': 148.646165311231, 'avg_cost': 444.19397331101777, 'action_ratio': 0.8631062001227747},
#  4: {'reward': 22.791591658146565, 'avg_cost': 352.6265706670359, 'action_ratio': 0.935},
#  5: {'reward': 43.96140514923469, 'avg_cost': 439.9153398926655, 'action_ratio': 0.882494004796163},
#  6: {'reward': 56.573017698009394, 'avg_cost': 440.80312247644684, 'action_ratio': 0.9200913242009132},
#  7: {'reward': 3.8382902189079218, 'avg_cost': 439.1381564920759, 'action_ratio': 0.9217391304347826}}


# EVN-2600 0.1
# {0: {'reward': -6.772089161578411, 'avg_cost': 253.00579570152138, 'action_ratio': 0.7336244541484717},
#  1: {'reward': -0.4160916133792118, 'avg_cost': 243.31143747218513, 'action_ratio': 0.7403508771929824},
#  2: {'reward': -13.102363187047919, 'avg_cost': 285.63932405954375, 'action_ratio': 0.7847560975609756},
#  3: {'reward': 99.62885208647327, 'avg_cost': 439.2124359300049, 'action_ratio': 0.8825015792798484},
#  4: {'reward': 17.304255644415104, 'avg_cost': 354.3852677489702, 'action_ratio': 0.9276018099547512},
#  5: {'reward': 32.29137216060653, 'avg_cost': 436.9596601073345, 'action_ratio': 0.9023746701846965},
#  6: {'reward': 27.70821058740749, 'avg_cost': 436.6642440556303, 'action_ratio': 0.8732718894009217},
#  7: {'reward': 1.7060013435271533, 'avg_cost': 439.5364224291095, 'action_ratio': 0.9196428571428571}}




# 3000query-steam.csv

# Epoch：2e4
# The total reward : 34.59915984219977
# io_cost :  [33360, 7136.0, 22788.0, 156590.0, 218165.0, 193125.0, 52256.0, 172395.0, 105694.0, 40496.0, 10368, 480, 4800, 36354.0, 34418.0, 42094.0, 57963.0, 47430.0, 26897.0, 64195.0, 5549.0, 19073.0, 10179.0, 6400, 1280, 4800, 2304, 37214.0, 48164.0, 32217.0, 128495.0, 31684.0, 34694.0, 49956.0, 8238.0, 5600, 4176, 2310.0, 960, 4800, 4260.0, 5424.0, 9012.0, 85610.0, 26591.0, 65961.0, 62125.0, 42254.0, 28683.0, 7104, 6132.0, 14333.0, 1416.0, 4800, 50675.0, 32034.0, 33472.0, 27691.0, 59366.0, 24911.0, 28567.0, 48961.0, 30768.0, 17446.0, 5099.0, 2638.0, 4800, 18924.0, 34061.0, 54887.0, 83996.0, 127569.0, 14760.0, 53271.0, 3120, 2157.0, 4704, 3600, 4800, 5848.0, 9076.0, 38308.0, 20700.0, 20601.0, 63517.0, 59058.0, 47492.0, 48590.0, 6054.0, 3312, 14599.0, 6816, 2451.0, 4800, 2400, 4800, 7220.0, 62595.0, 42715.0, 48080.0, 24725.0, 24996.0, 65753.0, 12679.0, 1052.0, 16938.0, 6400, 4800, 3824.0, 31140.0, 33682.0, 50045.0, 74490.0, 42331.0, 56514.0, 25864.0, 11410.0, 10864.0, 3200, 4800, 8111.0, 132178.0, 41576.0, 39718.0, 55195.0, 26993.0, 27447.0, 56108.0, 8560.0, 8430.0, 17158.0, 18796.0, 12720, 4800, 4224.0, 34606.0, 82679.0, 43619.0, 37038.0, 83170.0, 37342.0, 45199.0, 7131.0, 2240, 4800, 8832, 38201.0, 44501.0, 53816.0, 59851.0, 53541.0, 59685.0, 5080.0, 5002.0, 13440, 4800, 26631.0, 27500.0, 38820.0, 43472.0, 35233.0, 47068.0, 41690.0, 26997.0, 45527.0, 25224.0, 4800, 690.0, 4800, 9227.0, 10384.0, 32412.0, 37396.0, 39154.0, 60216.0, 117725.0, 26262.0, 24006.0, 21532.0, 10051.0, 4800, 5472, 3840, 2267.0, 12264.0, 35599.0, 52191.0, 35646.0, 24328.0, 27408.0, 75970.0, 30471.0, 33615.0, 3456, 2880, 4800, 12136.0, 11977.0, 55020.0, 20680.0, 25759.0, 43485.0, 14084.0, 11792.0, 8319.0, 6544.0, 2048.0, 10969.0, 4800, 1920, 4800, 6685.0, 6971.0, 16224.0, 63378.0, 34755.0, 68369.0, 7684.0, 8296.0, 2880, 4800, 1200.0, 2109.0, 27370.0, 16839.0, 39806.0, 43357.0, 8443.0, 26350.0, 22327.0, 768, 4992, 2080, 4800, 18653.0, 12217.0, 46572.0, 33692.0, 57555.0, 21920.0, 28132.0, 1228.0, 8931.0, 2110.0, 160, 4800, 6080, 16387.0, 58526.0, 36329.0, 54129.0, 12908.0, 9780.0, 14759.0, 4580.0, 2080, 4800, 10713.0, 74975.0, 19569.0, 21035.0, 16254.0, 36751.0, 20142.0, 5088, 8013.0, 1920, 693.0, 4800, 1176.0, 6528, 10740.0, 10322.0, 37636.0, 55594.0, 44457.0, 18009.0, 20090.0, 4000, 5600, 960, 4800, 20354.0, 22765.0, 38916.0, 14889.0, 28481.0, 101165.0, 24869.0, 15200, 25397.0, 14826.0, 13535.0, 40178.0, 2984.0, 7852.0, 960, 4800, 1600, 4800, 20717.0, 27185.0, 59831.0, 42126.0, 15915.0, 7912.0, 10237.0, 906.0, 7114.0]
# action list :  [[3, 1], [4, 0], [6, 1], [7, 1], [9, 1], [11, 1], [12, 1], [14, 0], [15, 0], [16, 0], [17, 0], [18, 1], [26, 0], [27, 1], [28, 1], [29, 1], [31, 1], [32, 1], [33, 0], [34, 0], [35, 0], [37, 0], [38, 0], [39, 0], [40, 1], [44, 0], [45, 0], [47, 1], [48, 1], [49, 0], [51, 1], [52, 0], [53, 0], [55, 0], [57, 0], [58, 0], [59, 0], [60, 0], [61, 1], [63, 0], [65, 1], [66, 0], [67, 0], [69, 1], [70, 0], [71, 1], [73, 0], [74, 0], [75, 0], [76, 0], [77, 1], [79, 1], [80, 1], [85, 0], [87, 1], [88, 1], [89, 0], [90, 0], [91, 0], [92, 0], [93, 0], [94, 1], [95, 0], [96, 0], [97, 0], [98, 1], [104, 0], [106, 0], [108, 1], [109, 1], [110, 1], [113, 1], [114, 0], [116, 1], [117, 0], [118, 0], [119, 0], [120, 1], [122, 0], [124, 0], [125, 1], [127, 1], [128, 0], [129, 1], [130, 0], [131, 0], [132, 0], [134, 0], [135, 0], [136, 0], [138, 1], [139, 0], [140, 1], [142, 0], [143, 1], [145, 0], [146, 0], [148, 1], [149, 1], [150, 0], [151, 0], [152, 0], [154, 0], [155, 0], [156, 0], [158, 0], [159, 1], [164, 0], [165, 0], [167, 1], [168, 0], [169, 1], [171, 1], [172, 1], [173, 1], [174, 0], [175, 0], [176, 0], [177, 1], [183, 0], [185, 0], [187, 1], [188, 1], [189, 0], [190, 1], [191, 0], [192, 0], [194, 1], [195, 0], [196, 0], [197, 1], [198, 0], [199, 1], [205, 0], [206, 1], [207, 1], [209, 1], [210, 1], [211, 0], [213, 1], [214, 0], [216, 1], [217, 0], [218, 1], [224, 0], [225, 0], [227, 1], [228, 0], [230, 0], [231, 1], [232, 0], [235, 1], [236, 0], [237, 0], [238, 1], [245, 0], [246, 1], [247, 1], [248, 0], [249, 1], [250, 1], [251, 1], [252, 1], [253, 0], [255, 1], [256, 1], [258, 0], [259, 1], [264, 0], [265, 0], [266, 1], [267, 0], [268, 1], [269, 1], [270, 1], [273, 1], [274, 0], [275, 0], [277, 1], [278, 1], [281, 0], [283, 1], [284, 0], [285, 0], [286, 0], [287, 0], [288, 1], [289, 0], [290, 0], [291, 0], [293, 1], [294, 0], [296, 0], [297, 0], [298, 1], [304, 0], [306, 0], [307, 0], [309, 1], [310, 0], [311, 0], [313, 0], [314, 0], [315, 1], [316, 0], [317, 0], [318, 0], [319, 1], [322, 0], [323, 1], [325, 0], [326, 0], [327, 1], [328, 0], [330, 0], [331, 1], [335, 0], [336, 0], [337, 0], [338, 1], [340, 0], [344, 0], [346, 0], [347, 1], [348, 0], [350, 0], [352, 0], [353, 0], [354, 0], [356, 0], [357, 0], [358, 1], [359, 1], [364, 0], [366, 0], [367, 0], [369, 1], [370, 0], [372, 0], [373, 0], [375, 1], [376, 0], [378, 1], [379, 0], [380, 1], [385, 0], [386, 0], [388, 0], [390, 0], [391, 0], [393, 0], [394, 0], [395, 1], [397, 1], [398, 0], [399, 1], [404, 0], [406, 0], [409, 0], [410, 0], [411, 0], [412, 0], [414, 1], [415, 1], [416, 0], [417, 0], [419, 0], [420, 1], [424, 0], [425, 0], [426, 0], [427, 1], [428, 1], [429, 0], [431, 0], [433, 1], [434, 0], [436, 0], [437, 0], [439, 0], [440, 1], [447, 0], [448, 1], [449, 0], [451, 0], [452, 0], [453, 1], [468, 0], [469, 0], [470, 0], [471, 0], [472, 0], [473, 0], [475, 0], [476, 0], [477, 1], [478, 1], [481, 0], [482, 1], [485, 0], [487, 0], [488, 1], [491, 0], [492, 0], [493, 0], [494, 0], [495, 1], [497, 0]]
# Average query cost: 247.7541017653167


# Epoch：1e5
# The total reward : 36.39236704495134
# io_cost :  [33360, 7136.0, 22788.0, 156590.0, 218165.0, 193125.0, 52256.0, 172395.0, 105694.0, 40496.0, 10368, 480, 4800, 36354.0, 34418.0, 42094.0, 57963.0, 47430.0, 26897.0, 64195.0, 5549.0, 10931.0, 28470.0, 1280, 4800, 2304, 11424, 15459.0, 49864.0, 85790.0, 71734.0, 32202.0, 66175.0, 21373.0, 6146.0, 7184.0, 4368, 2310.0, 960, 4800, 4260.0, 5424.0, 9012.0, 30895.0, 75645.0, 68386.0, 42269.0, 20048.0, 44749.0, 28683.0, 7104, 6132.0, 14333.0, 1416.0, 4800, 50675.0, 32034.0, 61611.0, 61402.0, 24911.0, 79963.0, 31520.0, 17446.0, 5099.0, 2638.0, 4800, 18924.0, 34061.0, 54887.0, 83996.0, 38412.0, 59118.0, 34274.0, 14184.0, 53271.0, 3120, 2157.0, 4704, 3600, 4800, 5848.0, 9076.0, 15999.0, 16950.0, 43060.0, 126211.0, 50162.0, 23149.0, 24495.0, 5579.0, 3312, 5666.0, 10809.0, 2451.0, 4800, 2400, 4800, 100809.0, 63870.0, 24725.0, 24996.0, 43457.0, 21480.0, 10685.0, 1052.0, 13368.0, 1548.0, 3200, 4800, 15114.0, 18103.0, 28408.0, 50045.0, 40783.0, 35438.0, 42587.0, 56514.0, 34355.0, 12608.0, 3200, 4800, 3273.0, 1072.0, 16048.0, 23088, 38023.0, 39718.0, 55195.0, 53494.0, 55233.0, 8560.0, 19312.0, 20571.0, 12720, 4800, 4224.0, 34606.0, 82679.0, 43619.0, 37038.0, 48458.0, 31470.0, 38878.0, 18606.0, 26953.0, 5408, 2240, 4800, 12220.0, 29457.0, 44501.0, 53816.0, 59851.0, 53541.0, 26008.0, 23796.0, 8224.0, 4896.0, 5002.0, 13440, 4800, 26631.0, 27500.0, 38820.0, 43472.0, 35233.0, 47068.0, 41690.0, 26997.0, 30888.0, 15642.0, 22240, 4800, 690.0, 4800, 9227.0, 10384.0, 32412.0, 37396.0, 39154.0, 60216.0, 117725.0, 26262.0, 24006.0, 21532.0, 10051.0, 4800, 5472, 3840, 69196.0, 51997.0, 60294.0, 27705.0, 41833.0, 33210.0, 27566.0, 33615.0, 3456, 2880, 4800, 12136.0, 11977.0, 18000.0, 36732.0, 46627.0, 24634.0, 19235.0, 14084.0, 27516.0, 2480.0, 10969.0, 4800, 1920, 4800, 6773.0, 16224.0, 25123.0, 38255.0, 28833.0, 30572.0, 18783.0, 26914.0, 3556.0, 8296.0, 2880, 4800, 2109.0, 27370.0, 32002.0, 24835.0, 84346.0, 12454.0, 10832, 672, 4992, 2080, 4800, 4157.0, 16480, 10905.0, 46572.0, 33692.0, 36001.0, 20620.0, 21435.0, 21152.0, 7364.0, 4477.0, 2560, 2110.0, 160, 4800, 6080, 3648.0, 12739.0, 24190.0, 93044.0, 28402.0, 8780.0, 9780.0, 10759.0, 8772.0, 2080, 4800, 6233.0, 20761.0, 15051.0, 39802.0, 18993.0, 37289.0, 9193.0, 30428.0, 15518.0, 14658.0, 3840, 4800, 3360, 1176.0, 6528, 10740.0, 10322.0, 112811.0, 24015.0, 17865.0, 13368.0, 6722.0, 4000, 5600, 960, 4800, 8332.0, 62274.0, 18558.0, 41285.0, 50470.0, 3688.0, 4478.0, 1280, 972.0, 4800, 7712.0, 13217.0, 18936.0, 27291.0, 15200, 25397.0, 28553.0, 33228.0, 11419.0, 6120.0, 960, 4800, 1600, 4800, 4544, 14186.0, 24967.0, 8917.0, 50914.0, 42126.0, 15915.0, 16565.0, 906.0, 0]
# action list :  [[3, 1], [4, 0], [6, 1], [7, 1], [9, 1], [11, 1], [12, 1], [14, 0], [15, 0], [16, 0], [17, 0], [18, 1], [26, 0], [27, 1], [28, 1], [29, 1], [31, 1], [32, 1], [33, 0], [34, 0], [35, 0], [36, 0], [39, 1], [40, 1], [44, 0], [45, 0], [46, 1], [47, 0], [48, 1], [50, 1], [51, 1], [52, 0], [54, 1], [55, 0], [56, 0], [58, 1], [59, 0], [60, 0], [61, 1], [63, 0], [65, 1], [66, 0], [67, 0], [68, 0], [70, 0], [71, 1], [72, 0], [73, 1], [74, 1], [75, 0], [76, 0], [77, 1], [79, 1], [80, 1], [85, 0], [87, 1], [88, 1], [90, 0], [91, 0], [92, 0], [94, 1], [95, 1], [96, 0], [97, 0], [98, 1], [104, 0], [106, 0], [108, 1], [109, 1], [110, 1], [111, 1], [112, 1], [113, 0], [114, 0], [116, 1], [117, 0], [118, 0], [119, 0], [120, 1], [122, 0], [124, 0], [125, 1], [126, 0], [127, 0], [129, 1], [131, 0], [132, 0], [133, 0], [134, 0], [135, 0], [136, 0], [137, 0], [139, 0], [140, 1], [142, 0], [143, 1], [145, 0], [149, 0], [150, 1], [151, 0], [152, 0], [153, 0], [154, 0], [155, 0], [156, 0], [157, 0], [158, 0], [159, 1], [164, 0], [166, 1], [167, 0], [168, 0], [169, 1], [170, 1], [171, 0], [172, 1], [173, 1], [175, 0], [176, 1], [177, 1], [183, 0], [184, 0], [185, 0], [186, 0], [187, 1], [188, 0], [189, 0], [190, 1], [192, 0], [194, 0], [195, 0], [197, 1], [198, 0], [199, 1], [205, 0], [206, 1], [207, 1], [209, 1], [210, 1], [211, 0], [212, 1], [213, 0], [214, 1], [215, 1], [216, 0], [217, 0], [218, 1], [225, 0], [226, 0], [227, 1], [228, 0], [230, 0], [231, 1], [232, 0], [233, 1], [234, 1], [235, 0], [236, 0], [237, 0], [238, 1], [245, 0], [246, 1], [247, 1], [248, 0], [249, 1], [250, 1], [251, 1], [252, 1], [253, 0], [254, 0], [255, 1], [256, 1], [258, 0], [259, 1], [264, 0], [265, 0], [266, 1], [267, 0], [268, 1], [269, 1], [270, 1], [273, 1], [274, 0], [275, 0], [277, 1], [278, 1], [281, 0], [283, 1], [284, 0], [287, 1], [288, 1], [290, 0], [291, 0], [292, 0], [293, 0], [294, 0], [296, 0], [297, 0], [298, 1], [304, 0], [306, 0], [307, 0], [308, 0], [309, 0], [311, 1], [312, 0], [313, 0], [314, 0], [317, 0], [318, 0], [320, 1], [322, 0], [323, 1], [326, 0], [327, 0], [328, 0], [329, 0], [330, 0], [331, 0], [332, 0], [333, 0], [335, 1], [336, 0], [337, 0], [338, 1], [344, 0], [346, 0], [347, 1], [349, 0], [350, 1], [354, 0], [355, 0], [356, 0], [357, 0], [358, 1], [359, 1], [364, 0], [365, 0], [366, 1], [367, 0], [369, 1], [370, 0], [371, 0], [372, 0], [373, 1], [374, 1], [375, 0], [377, 0], [378, 0], [379, 0], [380, 1], [385, 0], [386, 0], [387, 0], [388, 0], [389, 0], [392, 0], [393, 1], [394, 0], [395, 1], [396, 1], [398, 1], [399, 1], [405, 0], [406, 0], [407, 0], [408, 0], [409, 0], [410, 0], [412, 0], [413, 0], [414, 1], [415, 0], [417, 1], [418, 1], [420, 0], [424, 0], [425, 0], [426, 0], [427, 1], [428, 1], [432, 0], [433, 0], [434, 0], [435, 0], [436, 0], [437, 0], [439, 0], [440, 1], [446, 0], [447, 0], [450, 0], [451, 0], [453, 0], [455, 1], [456, 0], [457, 0], [458, 0], [459, 1], [465, 0], [466, 1], [467, 1], [468, 1], [469, 1], [470, 0], [471, 0], [473, 0], [474, 1], [476, 0], [477, 0], [478, 1], [481, 0], [482, 1], [485, 0], [486, 0], [487, 0], [488, 0], [489, 0], [491, 0], [492, 0], [493, 0], [495, 0], [496, 1]]
# Average query cost: 243.9683429758196


# 修改环境（增加误判导致的分区成本）
# The total reward : 11.312833706279418
# io_cost :  [33360, 8471.0, 8640, 16444.0, 133570.0, 203016.0, 77951.0, 163641.0, 48952.0, 174459.0, 107326.0, 122368.0, 13780.0, 18890.0, 31152.0, 34610.0, 42927.0, 54539.0, 1248, 90173.0, 67263.0, 864, 42536.0, 672, 480, 960, 33140.0, 51320.0, 85607.0, 72118.0, 76936.0, 28370.0, 672, 39683.0, 864, 864, 864, 864, 960, 24910.0, 768, 88884.0, 26495.0, 76873.0, 43725.0, 22574.0, 45037.0, 1344, 43535.0, 11477.0, 8424.0, 3424.0, 672, 768, 45033.0, 32161.0, 42328.0, 30235.0, 63408.0, 61158.0, 54141.0, 32288.0, 29326.0, 8697.0, 17799.0, 1056, 39290.0, 52551.0, 84092.0, 40140.0, 60782.0, 48170.0, 864, 480, 62178.0, 960, 15040.0, 16932.0, 23733.0, 22966.0, 22099.0, 72162.0, 73958.0, 50424.0, 55049.0, 1056, 864, 14307.0, 960, 11034.0, 480, 5568, 576, 13616.0, 31117.0, 33130.0, 101249.0, 49793.0, 47440.0, 31246.0, 1056, 19314.0, 8864, 4328.0, 16778.0, 17143.0, 35642.0, 53363.0, 40975.0, 37342.0, 43790.0, 59819.0, 30934.0, 11794.0, 15490.0, 288, 288, 288, 288, 288, 12064.0, 864, 3577.0, 20664.0, 68373.0, 41792.0, 90748.0, 29950.0, 27067.0, 40226.0, 864, 17731.0, 20763.0, 16540.0, 3564.0, 192, 33218.0, 31302.0, 53117.0, 239733.0, 1440, 1056, 1440, 43574.0, 46293.0, 52430.0, 62378.0, 1056, 78237.0, 24156.0, 11040.0, 62353.0, 25281.0, 196827.0, 28349.0, 49360.0, 29407.0, 1248, 1248, 1248, 1248, 1248, 1248, 1536, 23234.0, 1248, 67346.0, 45302.0, 102367.0, 46640.0, 58368.0, 1152, 1152, 768, 82350.0, 84431.0, 36130.0, 52627.0, 41833.0, 67273.0, 1056, 1152, 36318.0, 864, 105301.0, 26527.0, 672, 480, 72901.0, 192, 192, 192, 192, 192, 192, 192, 192, 192, 192, 384, 384, 384, 128560.0, 35043.0, 41195.0, 480, 27910.0, 192, 51510.0, 384, 384, 384, 384, 384, 384, 576, 576, 576, 576, 576, 576, 576, 576, 576, 576, 576, 170487.0, 384, 34292.0, 192, 131617.0, 672, 158421.0, 25551.0, 35946.0, 0, 22089.0, 3504, 11587.0, 44732.0, 960, 58540.0, 672, 576, 576, 672, 672, 672, 104542.0, 384, 384, 384, 384, 384, 384, 384, 384, 480, 384, 69505.0, 35898.0, 21504, 19773.0, 24111.0, 59511.0, 192, 288, 384, 576, 576, 576, 167453.0, 21757.0, 480, 151017.0, 480, 46668.0, 171465.0, 768, 960, 960, 960, 960, 960, 42420.0]
# action list :  [[2, 1], [3, 1], [4, 1], [5, 1], [6, 1], [7, 1], [9, 1], [10, 1], [11, 1], [13, 1], [14, 1], [15, 1], [17, 1], [25, 1], [26, 1], [27, 1], [28, 1], [29, 1], [32, 1], [34, 1], [39, 1], [46, 1], [47, 1], [49, 1], [50, 1], [52, 1], [53, 1], [59, 1], [66, 1], [68, 1], [69, 1], [70, 1], [71, 1], [72, 1], [73, 1], [76, 1], [77, 1], [78, 1], [79, 1], [86, 1], [87, 1], [88, 1], [89, 1], [90, 1], [92, 1], [93, 1], [94, 1], [95, 1], [97, 1], [104, 1], [107, 1], [108, 1], [109, 1], [110, 1], [111, 1], [113, 1], [122, 1], [124, 1], [125, 1], [126, 1], [127, 1], [128, 1], [129, 1], [130, 1], [131, 1], [134, 1], [137, 1], [140, 1], [142, 1], [145, 1], [146, 1], [147, 1], [149, 1], [151, 1], [152, 1], [154, 1], [157, 1], [158, 1], [163, 1], [165, 1], [166, 1], [167, 1], [168, 1], [169, 1], [170, 1], [171, 1], [172, 1], [173, 1], [174, 1], [175, 1], [182, 1], [184, 1], [185, 1], [187, 1], [188, 1], [190, 1], [191, 1], [192, 1], [194, 1], [196, 1], [197, 1], [198, 1], [204, 1], [206, 1], [207, 1], [208, 1], [217, 1], [226, 1], [227, 1], [229, 1], [230, 1], [232, 1], [233, 1], [234, 1], [245, 1], [246, 1], [251, 1], [252, 1], [254, 1], [256, 1], [265, 1], [267, 1], [268, 1], [270, 1], [271, 1], [273, 1], [285, 1], [287, 1], [288, 1], [290, 1], [291, 1], [293, 1], [296, 1], [309, 1], [310, 1], [314, 1], [329, 1], [330, 1], [332, 1], [335, 1], [347, 1], [365, 1], [367, 1], [372, 1], [390, 1], [391, 1], [393, 1], [397, 1], [398, 1], [404, 1], [407, 1], [409, 1], [416, 1], [428, 1], [429, 1], [430, 1], [431, 1], [432, 1], [438, 1], [453, 1], [454, 1], [471, 1], [473, 1], [491, 1]]
# Average query cost: 254.29787865301884

# 修改环境:增加adjust_times
# steps: 1e4
# The total reward : 3.083180567615681
# io_cost :  [33360, 8471.0, 8640, 16444.0, 133570.0, 203016.0, 77951.0, 163641.0, 250416.0, 480.0, 113385.0, 81152.0, 352.0, 51055.0, 39664.0, 42927.0, 68643.0, 48376.0, 86086.0, 416.0, 310085.0, 288.0, 61990.0, 384.0, 448.0, 448.0, 448.0, 448.0, 448.0, 448.0, 448.0, 448.0, 70027.0, 448.0, 544.0, 384.0, 256.0, 416.0, 256.0, 192.0, 288.0, 352.0, 352.0, 352.0, 352.0, 352.0, 348185.0, 352.0, 544.0, 544.0, 544.0, 544.0, 544.0, 576.0, 512.0, 544.0, 448.0, 106615.0, 30468.0, 92101.0, 31906.0, 84968.0, 416.0, 260350.0, 52972.0, 94040.0, 384.0, 384.0, 16054.0, 32991.0, 19212.0, 22966.0, 85522.0, 68964.0, 50424.0, 50046.0, 448.0, 384.0, 19401.0, 320.0, 97072.0, 480.0, 125723.0, 224.0, 160.0, 160.0, 256.0, 224.0, 128.0, 160.0, 160.0, 160.0, 160.0, 160.0, 444173.0, 160.0, 128.0, 416.0, 288.0, 224.0, 224.0, 0.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 0.0, 0.0, 0.0, 715914.0, 0.0, 44471.0, 320.0, 113800.0, 352.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 96.0, 118947.0, 96.0, 352.0, 40306.0, 144313.0, 41796.0, 41978.0, 256.0, 98916.0, 512.0, 544.0, 101200.0, 42642.0, 64408.0, 87664.0, 28678.0, 34996.0, 33197.0, 29351.0, 116329.0, 36034.0, 52627.0, 41833.0, 36387.0, 48907.0, 16716.0, 384.0, 384.0, 384.0, 384.0, 384.0, 384.0, 384.0, 384.0, 384.0, 384.0, 448.0, 544.0, 512.0, 544.0, 544.0, 544.0, 576.0, 576.0, 576.0, 576.0, 222665.0, 576.0, 256.0, 384.0, 416.0, 416.0, 352.0, 352.0, 352.0, 1831341.0]
# action list :  [[2, 1], [3, 1], [4, 1], [5, 1], [6, 1], [7, 1], [9, 1], [10, 1], [12, 1], [14, 1], [16, 1], [26, 1], [27, 1], [28, 1], [30, 1], [31, 1], [33, 1], [50, 1], [52, 1], [88, 1], [89, 1], [91, 1], [92, 1], [94, 1], [110, 1], [111, 1], [115, 1], [119, 1], [125, 1], [126, 1], [127, 1], [129, 1], [130, 1], [131, 1], [133, 1], [137, 1], [147, 1], [150, 1], [227, 1], [230, 1], [245, 1], [249, 1], [250, 1], [251, 1], [256, 1], [267, 1], [268, 1], [269, 1], [271, 1], [272, 1], [273, 1], [275, 1], [277, 1], [287, 1], [288, 1], [290, 1], [291, 1], [292, 1], [294, 1], [295, 1]]
# Average query cost: 244.07120605251447

# 增加训练轮数，效果不好
# steps: 3e4
# The total reward : 7.580368064919579
# io_cost :  [33360, 16703.0, 15324.0, 133570.0, 203016.0, 77951.0, 163641.0, 48952.0, 174459.0, 107326.0, 122368.0, 13780.0, 46493.0, 39664.0, 42927.0, 54539.0, 416.0, 60163.0, 28641.0, 77921.0, 288.0, 18757.0, 13814.0, 8768, 64.0, 64.0, 64.0, 256.0, 12153.0, 288.0, 25029.0, 49864.0, 85607.0, 72118.0, 76936.0, 28370.0, 224.0, 384.0, 416.0, 416.0, 416.0, 416.0, 416.0, 416.0, 416.0, 352.0, 352.0, 98824.0, 51711.0, 480.0, 99798.0, 49259.0, 22574.0, 75051.0, 448.0, 480.0, 24482.0, 8520.0, 3424.0, 256.0, 45033.0, 32161.0, 42328.0, 30235.0, 63408.0, 30884.0, 448.0, 85379.0, 32288.0, 29326.0, 8697.0, 256.0, 17799.0, 256.0, 352.0, 39290.0, 52551.0, 117199.0, 57861.0, 448.0, 48170.0, 288.0, 160.0, 160.0, 160.0, 256.0, 256.0, 256.0, 256.0, 256.0, 256.0, 384.0, 288.0, 288.0, 256.0, 256.0, 212034.0, 384.0, 60449.0, 74193.0, 320.0, 160.0, 256.0, 416.0, 416.0, 320.0, 224.0, 224.0, 224.0, 224.0, 352909.0, 256.0, 384.0, 384.0, 384.0, 384.0, 384.0, 384.0, 416.0, 320.0, 448.0, 43601.0, 35968.0, 53363.0, 40975.0, 37342.0, 97018.0, 28010.0, 11794.0, 18990.0, 9152.0, 3177.0, 224.0, 19386.0, 19725.0, 45197.0, 97225.0, 63176.0, 576.0, 56234.0, 288.0, 16344.0, 288.0, 384.0, 448.0, 448.0, 448.0, 448.0, 448.0, 448.0, 448.0, 448.0, 78611.0, 29089.0, 53117.0, 80525.0, 45927.0, 34854.0, 39550.0, 20238.0, 30421.0, 384.0, 384.0, 384.0, 384.0, 384.0, 384.0, 320.0, 352.0, 448.0, 56273.0, 46293.0, 320.0, 288.0, 113800.0, 352.0, 78581.0, 24156.0, 15720.0, 224.0, 57275.0, 25281.0, 39748.0, 41686.0, 42567.0, 83550.0, 29849.0, 33821.0, 16060.0, 26808.0, 416.0, 416.0, 416.0, 416.0, 416.0, 416.0, 512.0, 448.0, 448.0, 61697.0, 37526.0, 42222.0, 64408.0, 37423.0, 49177.0, 31880.0, 64373.0, 480.0, 384.0, 31837.0, 384.0, 384.0, 448.0, 448.0, 480.0, 480.0, 62127.0, 48808.0, 60806.0, 27729.0, 42872.0, 36387.0, 512.0, 64775.0, 416.0, 352.0, 352.0, 352.0, 352.0, 352.0, 352.0, 352.0, 352.0, 352.0, 352.0, 416.0, 480.0, 480.0, 512.0, 512.0, 512.0, 576.0, 576.0, 576.0, 576.0, 221949.0, 576.0, 416.0, 416.0, 416.0, 416.0, 416.0, 416.0, 416.0, 480.0, 480.0, 480.0, 480.0, 512.0, 576.0, 576.0, 512.0, 512.0, 512.0, 512.0, 512.0, 512.0, 512.0, 512.0, 512.0, 512.0, 512.0, 512.0, 512.0, 512.0, 512.0, 512.0, 512.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 544.0, 608.0, 640.0, 640.0, 576.0, 576.0, 576.0, 576.0, 576.0, 576.0, 576.0, 576.0, 576.0, 576.0, 576.0, 576.0, 576.0, 576.0, 576.0, 576.0, 576.0, 608.0, 608.0, 640.0, 640.0, 640.0, 640.0, 640.0, 640.0, 640.0, 823383.0, 640.0, 704.0, 704.0, 704.0, 704.0, 704.0, 704.0, 704.0, 704.0, 704.0, 239139.0, 640.0, 416.0, 448.0, 448.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 200554.0, 480.0, 544.0, 544.0, 672.0, 672.0, 672.0, 672.0, 672.0, 672.0, 672.0, 672.0, 672.0, 672.0, 672.0, 672.0, 672.0, 672.0, 672.0, 672.0, 672.0, 608.0, 608.0, 608.0, 608.0, 608.0, 608.0, 608.0, 608.0, 608.0, 608.0, 608.0, 608.0, 608.0, 608.0, 608.0, 608.0, 608.0, 608.0, 608.0, 544.0, 544.0, 480.0, 480.0, 480.0, 480.0, 480.0, 572922.0]
# action list :  [[2, 1], [4, 1], [5, 1], [6, 1], [7, 1], [9, 1], [10, 1], [11, 1], [13, 1], [14, 1], [15, 1], [17, 1], [26, 1], [27, 1], [28, 1], [29, 1], [31, 1], [32, 1], [34, 1], [36, 1], [37, 1], [38, 1], [44, 1], [46, 1], [47, 1], [49, 1], [50, 1], [52, 1], [53, 1], [67, 1], [68, 1], [70, 1], [71, 1], [72, 1], [74, 1], [77, 1], [78, 1], [80, 1], [86, 1], [87, 1], [88, 1], [89, 1], [90, 1], [91, 1], [93, 1], [94, 1], [95, 1], [97, 1], [104, 1], [107, 1], [108, 1], [110, 1], [111, 1], [113, 1], [130, 1], [132, 1], [166, 1], [167, 1], [168, 1], [169, 1], [170, 1], [172, 1], [173, 1], [174, 1], [176, 1], [182, 1], [183, 1], [185, 1], [186, 1], [187, 1], [189, 1], [191, 1], [193, 1], [195, 1], [206, 1], [207, 1], [208, 1], [210, 1], [211, 1], [212, 1], [213, 1], [214, 1], [215, 1], [226, 1], [227, 1], [230, 1], [232, 1], [233, 1], [235, 1], [245, 1], [246, 1], [247, 1], [248, 1], [249, 1], [251, 1], [252, 1], [253, 1], [254, 1], [255, 1], [266, 1], [267, 1], [268, 1], [269, 1], [270, 1], [271, 1], [272, 1], [274, 1], [277, 1], [286, 1], [287, 1], [289, 1], [290, 1], [291, 1], [292, 1], [295, 1]]
# Average query cost: 252.41246105919004


# 修改环境:增加倾斜度  PPO.load("stable_pretrained_model/ppo_controller_v2_skew")
# steps: 2e4
# The total reward : 22.9334534349594
# io_cost :  [33360, 160.0, 256.0, 352.0, 384.0, 448.0, 416.0, 416.0, 416.0, 384.0, 834727.0, 416.0, 6380.0, 142044.0, 122368.0, 352.0, 352.0, 352.0, 352.0, 352.0, 352.0, 352.0, 352.0, 384.0, 62997.0, 416.0, 43955.0, 42927.0, 54539.0, 416.0, 416.0, 384.0, 384.0, 384.0, 352.0, 352.0, 352.0, 352.0, 198409.0, 352.0, 448.0, 384.0, 480.0, 384.0, 416.0, 416.0, 320.0, 384.0, 384.0, 324522.0, 384.0, 33915.0, 224.0, 384.0, 384.0, 416.0, 416.0, 416.0, 416.0, 416.0, 416.0, 43037.0, 416.0, 4644.0, 8473.0, 12848.0, 36810.0, 55483.0, 480.0, 576.0, 480.0, 448.0, 288.0, 288.0, 288.0, 288.0, 416.0, 272357.0, 416.0, 576.0, 576.0, 576.0, 576.0, 576.0, 576.0, 512.0, 576.0, 512.0, 480.0, 544.0, 384.0, 416.0, 416.0, 381451.0, 416.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 416.0, 448.0, 448.0, 448.0, 448.0, 544.0, 416.0, 512.0, 544.0, 328145.0, 384.0, 17906.0, 20943.0, 35968.0, 256.0, 288.0, 288.0, 288.0, 288.0, 288.0, 352.0, 320.0, 320.0, 71174.0, 416.0, 23772.0, 288.0, 384.0, 480.0, 480.0, 352.0, 448.0, 384.0, 384.0, 384.0, 288407.0, 384.0, 224.0, 128.0, 128.0, 128.0, 128.0, 128.0, 128.0, 288.0, 352.0, 352.0, 129426.0, 416.0, 63793.0, 256.0, 256.0, 96.0, 192.0, 96.0, 96.0, 160.0, 160.0, 160.0, 142189.0, 160.0, 352.0, 288.0, 352.0, 416.0, 384.0, 352.0, 448.0, 352.0, 288.0, 276381.0, 288.0, 416.0, 320.0, 352.0, 352.0, 352.0, 352.0, 352.0, 352.0, 352.0, 58951.0, 352.0, 384.0, 416.0, 288.0, 224.0, 224.0, 160.0, 448.0, 352.0, 288.0, 244799.0, 288.0, 320.0, 352.0, 384.0, 352.0, 320.0, 256.0, 256.0, 256.0, 256.0, 86236.0, 256.0, 256.0, 256.0, 288.0, 96.0, 96.0, 96.0, 0.0, 128.0, 160.0, 160.0, 338208.0, 160.0, 256.0, 128.0, 256.0, 128.0, 256.0, 256.0, 320.0, 0.0, 0.0, 0.0, 708429.0, 0.0, 224.0, 416.0, 288.0, 256.0, 128.0, 128.0, 128.0, 224.0, 224.0, 297890.0, 224.0, 12637.0, 384.0, 384.0, 448.0, 480.0, 544.0, 448.0, 448.0, 384.0, 448.0, 324485.0, 416.0, 288.0, 416.0, 352.0, 352.0, 352.0, 352.0, 352.0, 352.0, 352.0, 44610.0, 352.0, 288.0, 288.0, 352.0, 448.0, 448.0, 480.0, 480.0, 480.0, 512.0, 195851.0, 512.0, 352.0, 352.0, 352.0, 352.0, 352.0, 352.0, 352.0, 352.0, 352.0, 32726.0, 352.0, 352.0, 352.0, 352.0, 352.0, 384.0, 384.0, 384.0, 384.0, 384.0, 384.0, 205057.0, 384.0, 288.0, 288.0, 288.0, 288.0, 288.0, 288.0, 352.0, 416.0, 416.0, 416.0, 416.0, 416.0, 416.0, 416.0, 159050.0, 416.0, 448.0, 512.0, 512.0, 448.0, 448.0, 448.0, 448.0, 448.0, 448.0, 384.0, 37871.0, 384.0, 352.0, 416.0, 480.0, 480.0, 448.0, 320.0, 320.0, 320.0, 320.0, 398012.0, 320.0, 288.0, 352.0, 352.0, 352.0, 352.0, 352.0, 352.0, 416.0, 416.0, 416.0, 49751.0, 416.0, 448.0, 480.0, 448.0, 448.0, 448.0, 448.0, 448.0, 448.0, 448.0, 384338.0, 448.0, 288.0, 288.0, 288.0, 288.0, 288.0, 288.0, 288.0, 288.0, 288.0, 288.0, 22802.0, 288.0, 288.0, 352.0, 352.0, 384.0, 384.0, 512.0, 544.0, 544.0, 544.0, 182723.0, 544.0, 288.0, 288.0, 288.0, 288.0, 288.0, 288.0, 288.0, 352.0, 320.0, 320.0, 288.0, 288.0, 352.0, 352.0, 288.0, 168278.0, 288.0, 288.0, 288.0, 288.0, 288.0, 288.0, 288.0, 288.0, 288.0, 288.0, 288.0, 25968.0, 288.0, 352.0, 320.0, 320.0, 448.0, 448.0, 448.0, 448.0, 448.0, 448.0, 188576.0]
# action list :  [[2, 1], [3, 0], [4, 0], [5, 0], [6, 0], [7, 0], [8, 0], [9, 0], [10, 0], [11, 0], [12, 0], [13, 1], [14, 1], [15, 1], [17, 0], [18, 0], [19, 0], [20, 0], [21, 0], [22, 0], [23, 0], [24, 0], [25, 0], [26, 0], [27, 1], [28, 1], [29, 1], [30, 0], [31, 0], [34, 0], [35, 0], [36, 0], [37, 0], [38, 0], [39, 0], [40, 0], [41, 0], [43, 0], [44, 0], [45, 0], [46, 0], [47, 0], [48, 0], [49, 0], [50, 0], [51, 0], [52, 0], [53, 1], [54, 0], [55, 0], [56, 0], [57, 0], [58, 0], [59, 0], [60, 0], [61, 0], [62, 0], [63, 0], [64, 1], [65, 1], [66, 1], [67, 1], [68, 1], [69, 0], [70, 0], [71, 0], [72, 0], [73, 0], [74, 0], [75, 0], [76, 0], [77, 0], [78, 0], [79, 0], [80, 0], [81, 0], [82, 0], [83, 0], [84, 0], [85, 0], [86, 0], [87, 0], [88, 0], [89, 0], [90, 0], [93, 0], [95, 0], [96, 0], [97, 0], [98, 0], [99, 0], [100, 0], [101, 0], [102, 0], [103, 0], [104, 0], [105, 0], [106, 0], [107, 0], [108, 0], [109, 0], [110, 0], [111, 0], [112, 0], [113, 1], [114, 1], [115, 1], [117, 0], [118, 0], [119, 0], [120, 0], [121, 0], [122, 0], [123, 0], [124, 0], [125, 0], [126, 0], [127, 1], [128, 0], [129, 0], [130, 0], [131, 0], [132, 0], [133, 0], [134, 0], [135, 0], [136, 0], [137, 0], [138, 0], [139, 0], [140, 0], [141, 0], [142, 0], [143, 0], [144, 0], [145, 0], [146, 0], [147, 0], [148, 0], [149, 1], [150, 0], [151, 0], [152, 0], [153, 0], [154, 0], [155, 0], [156, 0], [157, 0], [158, 0], [159, 0], [163, 0], [164, 0], [165, 0], [166, 0], [167, 0], [168, 0], [169, 0], [170, 0], [171, 0], [172, 0], [173, 0], [174, 0], [175, 0], [176, 0], [177, 0], [178, 0], [179, 0], [180, 0], [181, 0], [182, 0], [183, 0], [184, 0], [185, 0], [186, 0], [187, 0], [188, 0], [189, 0], [190, 0], [191, 0], [192, 0], [193, 0], [194, 0], [195, 0], [196, 0], [197, 0], [198, 0], [199, 0], [200, 0], [201, 0], [202, 0], [204, 0], [205, 0], [206, 0], [207, 0], [208, 0], [211, 0], [213, 0], [214, 0], [215, 0], [216, 0], [217, 0], [223, 0], [224, 0], [225, 0], [226, 0], [227, 0], [228, 0], [229, 0], [230, 0], [231, 0], [234, 0], [266, 0], [267, 0], [268, 0], [269, 0], [270, 0], [271, 0], [272, 0], [273, 0], [274, 0], [275, 0], [276, 0], [277, 1], [280, 0], [281, 0], [282, 0], [287, 0], [288, 0], [289, 0], [290, 0], [291, 0], [292, 0], [293, 0], [294, 0], [295, 0], [296, 0], [297, 0], [298, 0], [299, 0], [300, 0], [301, 0], [302, 0], [303, 0], [305, 0], [306, 0], [307, 0], [308, 0], [309, 0], [310, 0], [311, 0], [312, 0], [313, 0], [314, 0], [315, 0], [316, 0], [317, 0], [318, 0], [319, 0], [320, 0], [321, 0], [322, 0], [323, 0], [324, 0], [325, 0], [326, 0], [327, 0], [328, 0], [329, 0], [333, 0], [334, 0], [335, 0], [336, 0], [337, 0], [338, 0], [339, 0], [340, 0], [341, 0], [342, 0], [343, 0], [344, 0], [345, 0], [346, 0], [347, 0], [348, 0], [349, 0], [350, 0], [351, 0], [352, 0], [353, 0], [354, 0], [355, 0], [356, 0], [357, 0], [358, 0], [359, 0], [360, 0], [361, 0], [362, 0], [363, 0], [364, 0], [365, 0], [366, 0], [367, 0], [369, 0], [370, 0], [391, 0], [392, 0], [393, 0], [394, 0], [395, 0], [396, 0], [397, 0], [398, 0], [399, 0], [400, 0], [401, 0], [402, 0], [403, 0], [404, 0], [405, 0], [406, 0], [407, 0], [408, 0], [427, 0], [428, 0], [429, 0], [431, 0], [432, 0], [433, 0], [434, 0], [435, 0], [436, 0], [437, 0], [438, 0], [439, 0], [440, 0], [441, 0], [442, 0], [443, 0], [444, 0], [445, 0], [446, 0], [447, 0], [448, 0], [449, 0], [451, 0], [452, 0], [453, 0], [454, 0], [455, 0], [456, 0], [457, 0], [458, 0], [459, 0], [460, 0], [461, 0], [462, 0], [463, 0], [464, 0], [465, 0], [466, 0], [467, 0], [468, 0], [469, 0], [470, 0], [471, 0], [472, 0], [473, 0], [474, 0], [475, 0], [476, 0], [477, 0], [478, 0], [479, 0], [480, 0], [481, 0], [482, 0], [483, 0], [484, 0], [485, 0], [486, 0], [489, 0], [492, 0], [493, 0], [494, 0], [495, 0], [496, 0], [497, 0]]
# Average query cost: 249.526598427533

# reward_threshold=0
# The total reward : 10.725135837287395
# io_cost :  [33360, 8471.0, 21860.0, 385942.0, 31645.0, 480.0, 186096.0, 169748.0, 448.0, 112369.0, 68544.0, 13780.0, 46493.0, 39664.0, 42927.0, 54539.0, 60163.0, 28641.0, 77921.0, 288.0, 18757.0, 13814.0, 47575.0, 51841.0, 85607.0, 102757.0, 39668.0, 29648.0, 224.0, 178613.0, 67896.0, 43725.0, 22574.0, 45037.0, 36683.0, 384.0, 18543.0, 8328.0, 3424.0, 224.0, 11684.0, 31626.0, 32161.0, 134515.0, 29796.0, 29959.0, 54989.0, 32288.0, 147663.0, 208254.0, 16280.0, 20943.0, 35968.0, 224.0, 5970.0, 6432, 5184, 128.0, 128.0, 7992.0, 8394.0, 16740.0, 66442.0, 129747.0, 49350.0, 26989.0, 26401.0, 320.0, 384.0, 14971.0, 12757.0, 7041.0, 3168, 3584, 13718.0, 31117.0, 67362.0, 60262.0, 48487.0, 47440.0, 21288.0, 14779.0, 14324.0, 288.0, 56782.0, 35968.0, 53363.0, 40975.0, 37342.0, 163454.0, 384.0, 20568.0, 19725.0, 84062.0, 55667.0, 31450.0, 36658.0, 27067.0, 32946.0, 8080.0, 7068.0, 32109.0, 16636.0, 3564.0, 64.0, 156306.0, 42143.0, 83867.0, 37438.0, 20238.0, 38256.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 416.0, 15736.0, 12702.0, 28485.0, 94977.0, 65006.0, 53676.0, 27512.0, 40294.0, 13097.0, 67729.0, 41187.0, 41686.0, 42567.0, 47068.0, 41978.0, 27638.0, 33821.0, 43662.0, 480.0, 480.0, 480.0, 480.0, 480.0, 480.0, 12777.0, 9227.0, 7596.0, 35921.0, 74301.0, 58935.0, 37423.0, 49177.0, 31880.0, 34996.0, 33197.0, 29351.0, 154750.0, 50484.0, 41833.0, 36387.0, 512.0, 48907.0, 19916.0, 384.0, 327820.0, 32339.0, 26732.0, 160.0, 26201.0, 192.0, 192.0, 26427.0, 3264, 1872, 1200.0, 96.0, 77628.0, 128.0, 101697.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 64.0, 96.0, 39649.0, 23339.0, 17242.0, 33884.0, 37133.0, 24887.0, 22016.0, 24224.0, 6980.0, 128.0, 128.0, 128.0, 128.0, 128.0, 128.0, 128.0, 128.0, 128.0, 96.0, 64.0, 92668.0, 61016.0, 28498.0, 12352.0, 64.0, 128.0, 21445.0, 7299.0, 128.0, 128.0, 33475.0, 15339.0, 62727.0, 224.0, 192.0, 74462.0, 64.0, 64.0, 30272.0, 64.0, 68361.0, 35898.0, 21504, 19773.0, 24111.0, 192.0, 224.0, 93222.0, 96.0, 128.0, 192.0, 192.0, 192.0, 136156.0, 21757.0, 57450.0, 26273.0, 16112, 25589.0, 70177.0, 2792.0, 7080.0, 2080, 1600, 7597.0, 44137.0, 128.0, 128.0, 102725.0, 128.0, 42420.0]
# action list :  [[2, 1], [3, 1], [5, 1], [8, 1], [9, 1], [10, 0], [11, 1], [12, 1], [13, 0], [14, 1], [15, 1], [17, 1], [26, 1], [27, 1], [28, 1], [29, 1], [31, 1], [32, 1], [34, 1], [35, 0], [36, 1], [37, 1], [46, 1], [47, 1], [49, 1], [51, 1], [52, 1], [53, 1], [54, 0], [69, 1], [70, 1], [71, 1], [72, 1], [73, 1], [75, 1], [76, 0], [77, 1], [78, 1], [79, 1], [84, 0], [85, 1], [86, 1], [87, 1], [90, 1], [91, 1], [92, 1], [93, 1], [94, 1], [108, 1], [112, 1], [113, 1], [114, 1], [115, 1], [116, 0], [117, 1], [118, 1], [119, 1], [121, 0], [122, 0], [123, 1], [124, 1], [125, 1], [128, 1], [130, 1], [131, 1], [132, 1], [133, 1], [134, 0], [135, 0], [136, 1], [138, 1], [139, 1], [141, 1], [142, 1], [145, 1], [146, 1], [148, 1], [149, 1], [151, 1], [152, 1], [153, 1], [154, 1], [156, 1], [157, 0], [166, 1], [167, 1], [168, 1], [169, 1], [170, 1], [183, 1], [184, 0], [185, 1], [186, 1], [188, 1], [189, 1], [190, 1], [191, 1], [192, 1], [193, 1], [194, 1], [195, 1], [197, 1], [198, 1], [204, 1], [205, 0], [209, 1], [210, 1], [212, 1], [213, 1], [214, 1], [216, 1], [217, 0], [218, 0], [219, 0], [220, 0], [221, 0], [222, 0], [223, 0], [224, 1], [225, 1], [226, 1], [229, 1], [230, 1], [231, 1], [232, 1], [235, 1], [237, 1], [246, 1], [247, 1], [248, 1], [249, 1], [250, 1], [251, 1], [252, 1], [253, 1], [255, 1], [257, 0], [258, 0], [259, 0], [260, 0], [261, 0], [262, 0], [263, 1], [264, 1], [265, 1], [266, 1], [268, 1], [269, 1], [270, 1], [271, 1], [272, 1], [273, 1], [275, 1], [277, 1], [288, 1], [290, 1], [291, 1], [292, 1], [293, 0], [294, 1], [296, 1], [297, 0], [329, 1], [330, 1], [331, 1], [332, 0], [333, 1], [334, 0], [335, 0], [336, 1], [338, 1], [339, 1], [343, 1], [345, 0], [349, 1], [350, 0], [355, 1], [356, 0], [357, 0], [358, 0], [359, 0], [360, 0], [361, 0], [362, 0], [363, 0], [364, 0], [365, 0], [366, 1], [367, 1], [368, 1], [369, 1], [370, 1], [371, 1], [372, 1], [373, 1], [374, 1], [375, 0], [377, 0], [378, 0], [379, 0], [380, 0], [381, 0], [382, 0], [383, 0], [384, 0], [385, 0], [387, 0], [389, 1], [391, 1], [392, 1], [394, 1], [395, 0], [397, 0], [399, 1], [403, 1], [404, 0], [405, 0], [406, 1], [407, 1], [409, 1], [410, 0], [412, 0], [413, 1], [414, 0], [415, 0], [416, 1], [417, 0], [428, 1], [429, 1], [430, 1], [431, 1], [432, 1], [433, 0], [434, 0], [447, 1], [448, 0], [449, 0], [450, 0], [451, 0], [452, 0], [453, 1], [454, 1], [467, 1], [468, 1], [469, 1], [470, 1], [474, 1], [475, 1], [477, 1], [480, 1], [481, 1], [485, 1], [487, 1], [488, 0], [490, 0], [491, 1], [492, 0]]
# Average query cost: 251.52582702863077


# reward_threshold=0.1 （No skew degree）
# The total reward : -0.7974545893337502
# io_cost :  [111680.0, 8640, 202554.0, 173898.0, 224.0, 224.0, 224.0, 224.0, 224.0, 224.0, 224.0, 224.0, 224.0, 939249.0, 224.0, 192.0, 192.0, 192.0, 192.0, 192.0, 192.0, 192.0, 256.0, 256.0, 1991972.0, 256.0, 384.0, 192.0, 192.0, 192.0, 192.0, 192.0, 192.0, 192.0, 192.0, 2229542.0, 192.0, 2381416.0]
# action list :  [[3, 1], [4, 1], [6, 1], [7, 1], [12, 0], [13, 0], [14, 0], [33, 0], [34, 0], [35, 0], [36, 0], [37, 0], [38, 0], [39, 0], [140, 0], [141, 0], [142, 0], [143, 0], [144, 0], [145, 0], [146, 0], [147, 0], [148, 0], [149, 0], [150, 0], [269, 0], [270, 0], [271, 0], [272, 0], [273, 0], [274, 0], [275, 0], [276, 0], [277, 0]]
# Average query cost: 238.70093457943926 (If the env use skew,then total reward is 245.3575730603768.)

# 1500-query-steam
# reward_threshold=0.1 （No skew degree）
# The total reward : -0.8648415168621376
# io_cost :  [153501.0, 63826.0, 256.0, 256.0, 192.0, 192.0, 192.0, 192.0, 192.0, 288.0, 288.0, 664762.0, 288.0, 288.0, 288.0, 288.0, 288.0, 288.0, 288.0, 288.0, 288.0, 288.0, 880041.0, 288.0, 192.0, 288.0, 288.0, 288.0, 288.0, 288.0, 288.0, 288.0, 288.0, 1014897.0, 288.0, 288.0, 1398982.0]
# action list :  [[5, 1], [6, 1], [8, 0], [10, 0], [14, 0], [15, 0], [16, 0], [17, 0], [18, 0], [49, 0], [50, 0], [51, 0], [133, 0], [134, 0], [135, 0], [136, 0], [144, 0], [145, 0], [146, 0], [147, 0], [148, 0], [149, 0], [150, 0], [248, 0], [249, 0], [250, 0], [251, 0], [252, 0], [253, 0], [254, 0], [255, 0], [256, 0], [257, 0]]
# Average query cost: 252.61392175802945

# reward_threshold>=0 （No skew degree）
# The total reward : 0.4577305955827589
# io_cost :  [153501.0, 63826.0, 78152.0, 217707.0, 56218.0, 213377.0, 512.0, 342203.0, 338731.0, 478378.0, 416.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 667883.0, 0.0, 256.0, 64.0, 64.0, 1358131.0]
# action list :  [[5, 1], [6, 1], [8, 1], [12, 1], [13, 1], [46, 1], [47, 0], [78, 1], [114, 1], [185, 1], [186, 0], [248, 0], [249, 0], [250, 0], [252, 0], [255, 0], [256, 0], [257, 0], [258, 0], [259, 0], [260, 0], [261, 0], [494, 0], [495, 0]]
# Average query cost: 239.6413305964743
# （去掉  adjust_times判断） 243.349
# 总结：奖励阈值不同，对结果影响很大。


# 4000query-steam
# reward_threshold=0.1 （No skew degree）
# action list :  dict_keys([2, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 34, 35, 36, 48, 49, 50, 51, 52, 53, 55, 68, 69, 70, 71, 72, 73, 74, 75, 76, 93, 94, 95, 98, 114, 117, 118, 120, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 153, 154, 155, 156, 158, 173, 174, 175, 177, 189, 190, 191, 192, 193, 194, 195, 196, 213, 214, 216, 217, 234, 235, 236, 252, 253, 254, 256, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 295, 296, 298, 299, 314, 334, 335, 337, 351, 352, 353, 354, 355, 357, 359, 373, 374, 375, 376, 377, 380, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 396, 414, 415, 416, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 450, 451, 452, 453, 454, 455, 457, 475, 476, 477, 478, 494, 495, 496, 497, 498])
# [2, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 34, 36, 48, 49, 50, 51, 52, 53, 55, 68, 69, 70, 108, 109, 110, 111, 112, 113, 114, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 153, 154, 155, 156, 167, 168, 169, 170, 171, 172, 173, 174, 175, 177, 189, 190, 191, 192, 214, 215, 229, 230, 231, 232, 233, 235, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 294, 295, 296, 298, 299, 313, 334, 335, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 357, 359, 373, 374, 375, 376, 377, 380, 394, 405, 406, 407, 408, 409, 410, 411, 412, 434, 435, 436, 450, 451, 452, 453, 454, 467, 468, 469, 470, 472, 473, 474, 476, 477, 478, 493, 494, 495]
# Average query cost: 441.026252236136



# The total reward : 27.279055807483235（去掉judge_punishment的返回值，完全依据reward）
# io_cost :  [57840, 26420.0, 275655.0, 42810.0, 52414.0, 103515.0, 80633.0, 378687.0, 406559.0, 326020.0, 52595.0, 33193.0, 49185.0, 297631.0, 28721.0, 10948.0, 480.0, 640.0, 832.0, 960.0, 928.0, 864.0, 1088.0, 896.0, 896.0, 589130.0, 896.0, 56460.0, 832.0, 37278.0, 640.0, 768.0, 768.0, 768.0, 768.0, 608.0, 608.0, 800.0, 832.0, 1056.0, 168902.0, 640.0, 63492.0, 95515.0, 105624.0, 74588.0, 1216.0, 1280.0, 1248.0, 1248.0, 1280.0, 1280.0, 1280.0, 1280.0, 1280.0, 174360.0, 1312.0, 13791.0, 256.0, 512.0, 864.0, 1120.0, 1088.0, 1056.0, 1120.0, 1056.0, 1152.0, 607945.0, 1056.0, 22000.0, 34259.0, 35974.0, 512.0, 512.0, 512.0, 512.0, 512.0, 512.0, 608.0, 640.0, 928.0, 177866.0, 864.0, 69045.0, 1024.0, 992.0, 1056.0, 864.0, 832.0, 864.0, 864.0, 864.0, 928.0, 381518.0, 928.0, 768.0, 800.0, 960.0, 1088.0, 1152.0, 1088.0, 1152.0, 1184.0, 1056.0, 623828.0, 1248.0, 704.0, 896.0, 896.0, 896.0, 992.0, 992.0, 960.0, 1024.0, 1024.0, 1088.0, 154826.0, 1152.0, 69602.0, 113116.0, 85165.0, 928.0, 864.0, 992.0, 992.0, 832.0, 960.0, 960.0, 960.0, 928.0, 319173.0, 928.0, 672.0, 672.0, 736.0, 864.0, 1024.0, 864.0, 960.0, 960.0, 896.0, 683967.0, 896.0, 672.0, 672.0, 672.0, 672.0, 672.0, 800.0, 896.0, 1056.0, 1024.0, 960.0, 928.0, 992.0, 960.0, 1120.0, 531684.0, 1056.0, 30714.0, 46801.0, 39888.0, 35010.0, 576.0, 576.0, 576.0, 704.0, 704.0, 864.0, 1056.0, 1056.0, 1216.0, 307925.0, 1088.0, 126350.0, 92782.0, 55519.0, 960.0, 992.0, 1024.0, 1056.0, 1056.0, 1024.0, 1024.0, 1024.0, 1024.0, 187950.0, 1024.0, 608.0, 832.0, 960.0, 992.0, 1056.0, 1056.0, 960.0, 1024.0, 1120.0, 566803.0, 1088.0, 47738.0, 48713.0, 18462.0, 160.0, 352.0, 352.0, 352.0, 352.0, 352.0, 384.0, 544.0, 768.0, 1024.0, 102181.0, 992.0, 83084.0, 1344.0, 1216.0, 1152.0, 1216.0, 1216.0, 1152.0, 1280.0, 1152.0, 1152.0, 479476.0, 1152.0, 31385.0, 480.0, 768.0, 896.0, 672.0, 832.0, 864.0, 1024.0, 896.0, 1024.0, 628373.0, 928.0, 40711.0, 960.0, 960.0, 1280.0, 1152.0, 1184.0, 1056.0, 1248.0, 1280.0, 1216.0, 1248.0, 668880.0, 1248.0, 48073.0, 13725.0, 17351.0, 7896.0, 384.0, 448.0, 832.0, 896.0, 992.0, 992.0, 1024.0, 992.0, 992.0, 570251.0, 992.0, 49007.0, 22551.0, 39596.0, 480.0, 19011.0, 12818.0, 256.0, 544.0, 768.0, 864.0, 1120.0, 1024.0, 1024.0, 1056.0, 1088.0, 692929.0, 1024.0, 23842.0, 640.0, 736.0, 768.0, 768.0, 768.0, 672.0, 672.0, 672.0, 608.0, 672.0, 60730.0, 800.0, 39350.0, 68712.0, 66281.0, 120334.0, 85129.0, 113902.0, 57349.0, 70549.0, 1024.0, 1088.0, 1152.0, 1120.0, 1120.0, 1120.0, 1120.0, 1088.0, 1088.0, 96972.0, 1088.0, 25156.0, 35036.0, 76224.0, 32587.0, 93838.0, 72523.0, 73826.0, 111733.0, 71168.0, 38770.0, 41570.0, 928.0, 960.0, 960.0, 960.0, 960.0, 960.0, 960.0, 1056.0, 1088.0, 94309.0, 1088.0, 62613.0, 115523.0, 149909.0, 78250.0, 84793.0, 104074.0, 45406.0, 44454.0, 19976.0, 18155.0, 23963.0, 384.0, 8312.0, 352.0, 416.0, 800.0, 1024.0, 992.0, 928.0, 928.0, 896.0, 960.0, 1024.0, 628676.0, 928.0, 24577.0, 512.0, 768.0, 768.0, 768.0, 768.0, 768.0, 768.0, 768.0, 768.0, 73444.0, 992.0, 30856.0, 47717.0, 63331.0, 200764.0, 125856.0, 96261.0, 1120.0, 1120.0, 992.0, 1024.0, 1152.0, 1088.0, 1088.0, 1088.0, 1088.0, 210811.0, 1088.0, 768.0, 864.0, 1152.0, 1120.0, 1216.0, 1248.0, 1184.0, 1120.0, 1088.0, 609855.0, 1056.0, 24398.0, 13707.0, 704.0, 704.0, 704.0, 704.0, 704.0, 800.0, 832.0, 704.0, 1056.0, 206625.0, 1056.0, 42432.0, 66451.0, 111662.0, 79020.0, 81292.0, 62124.0, 960.0, 1024.0, 1088.0, 1056.0, 1056.0, 1056.0, 1056.0, 1056.0, 1056.0, 88993.0, 1088.0, 45789.0, 22075.0, 59697.0, 137951.0, 67253.0, 88060.0, 140509.0, 62689.0, 38886.0, 928.0, 52044.0, 19624.0, 21329.0, 128.0, 128.0, 128.0, 128.0, 416.0, 928.0, 864.0, 992.0, 992.0, 1056.0, 1088.0, 928.0, 497230.0, 928.0, 84850.0, 86203.0, 36616.0, 800.0, 864.0, 928.0, 928.0, 928.0, 38128.0]
# action list :  dict_keys([2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 34, 36, 48, 49, 50, 51, 63, 74, 75, 76, 89, 127, 128, 129, 173, 174, 175, 176, 189, 190, 191, 213, 214, 215, 228, 242, 255, 275, 276, 277, 278, 294, 295, 296, 298, 299, 314, 326, 327, 328, 329, 330, 331, 332, 333, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 366, 368, 369, 370, 371, 372, 373, 374, 375, 376, 378, 380, 394, 405, 406, 407, 409, 410, 411, 434, 435, 448, 449, 450, 451, 452, 453, 465, 466, 467, 468, 469, 470, 472, 473, 474, 476, 477, 478, 493, 494, 495])
# Average query cost: 439.3831395348837
# 考察其迁移性
#  永远是1： Average query cost: 441.59257602862255
#                                                                                                 2600state   2600normal    feedback    env-mask   env-par-mask  env-mask-curve   Feedback
#  在5000query-steam  :  Average query cost: 438                                                    443        437.60         447.92     424.14     416.33        422.78           447.92
#  在4000query-steam  :  Average query cost: 439.3831395348837                                                 437.47                    411.66     415.90        428.64           425.52
#  在3000query-steam  :  Average query cost: 249.62020471740098   原训练 238.70093457943926          248.87     244.03         259.49     237.05     247.40        255.03           259.49
#  在1500query-steam  :  Average query cost: 254.12569427674475   原训练 239.6413305964743           256.08     254.51         266.02     245.01     250.14        258.61           266.02


# reward_threshold=0.1 （With Classifier）
# action list :  dict_keys([2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 34, 36, 48, 49, 50, 51, 52, 53, 55, 68, 69, 70, 106, 107, 108, 109, 110, 111, 112, 113, 114, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 153, 154, 155, 156, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 189, 190, 191, 192, 214, 215, 228, 229, 230, 231, 232, 233, 234, 235, 236, 250, 251, 252, 253, 254, 255, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 294, 295, 296, 298, 299, 313, 334, 335, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 357, 359, 373, 374, 375, 376, 377, 380, 394, 405, 406, 407, 408, 409, 410, 411, 412, 434, 435, 436, 448, 449, 450, 451, 452, 453, 454, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 476, 477, 478, 493, 494, 495])
# 区别额外增加的action ——> [4, 106, 107, 176, 228, 234, 236, 250, 251, 252, 253, 254, 255, 448, 449, 465, 466, 471]
#   time      4      176          234    255      471
#   reward  0.1967  0.3260318   0.2259   0.176   0.389739

# Average query cost: 441.8067531305903 (No Classifier = 441.0262522)


# 2600query-steam
# env-speedup
# The total reward : 14.205584907759265
# io_cost :  [71360.0, 17640.0, 256019.0, 54904.0, 47156.0, 653878.0, 457381.0, 1379425.0, 84864.0, 114169.0, 146861.0, 77225.0, 71386.0, 20336.0, 31858.0, 30339.0, 2663.0, 640.0, 8640.0, 9243.0, 18979.0, 36885.0, 56904.0, 96174.0, 82397.0, 75514.0, 118899.0, 120082.0, 135493.0, 72786.0, 24709.0, 16467.0, 38623.0, 28446.0, 59315.0, 69635.0, 104083.0, 133322.0, 83892.0, 139000.0, 70325.0, 133766.0, 41748.0, 29924.0, 13486.0, 11116.0, 25319.0, 43636.0, 41358.0, 47309.0, 101672.0, 144182.0, 130335.0, 111027.0, 100700.0, 73033.0, 48015.0, 26823.0, 37685.0, 21252.0, 8788.0, 16388.0, 24795.0, 63157.0, 70759.0, 57408.0, 163518.0, 131818.0, 112125.0, 91174.0, 108917.0, 41474.0, 54649.0, 10819.0, 768.0, 16210464.0]
# action list :  dict_keys([2, 4, 5, 6, 7, 8, 9, 29, 30, 31, 32, 33, 35, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 65, 66, 67, 68, 69, 70, 71, 73, 74, 80, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114])
# Average query cost: 421.12739344997755
# Environment adaption ratio: 0.9726027397260274， 71 73

# env-normal
# The total reward : 17.304255644415104
# io_cost :  [70080, 15040.0, 55741.0, 68821.0, 44394.0, 130598.0, 60239.0, 24588.0, 46290.0, 19423.0, 28625.0, 23142.0, 213018.0, 75707.0, 39663.0, 22309.0, 51656.0, 26886.0, 480.0, 223809.0, 67253.0, 145147.0, 1024.0, 74960.0, 115020.0, 182553.0, 195653.0, 187870.0, 270740.0, 253850.0, 278456.0, 273159.0, 203655.0, 67778.0, 115007.0, 57390.0, 32875.0, 13240.0, 16061.0, 204389.0, 89170.0, 112282.0, 127936.0, 86124.0, 75874.0, 98456.0, 88473.0, 33201.0, 16136.0, 12313.0, 8152.0, 244066.0, 87233.0, 86079.0, 64801.0, 69562.0, 71334.0, 69935.0, 29469.0, 864.0, 896.0, 165708.0, 85811.0, 69156.0, 106032.0, 236126.0, 28203.0, 800.0, 137785.0, 53263.0, 68580.0, 38155.0, 81902.0, 24186.0, 9472.0, 5610.0, 101145.0, 65158.0, 47472.0, 86661.0, 544.0, 544.0, 544.0, 44751.0, 214135.0, 14326.0, 11810.0, 19546.0, 10408.0, 8088.0, 520673.0, 202651.0, 721091.0, 64405.0, 67523.0, 366523.0, 28037.0, 47348.0, 288.0, 288.0, 259102.0, 80724.0, 162304.0, 416.0, 416.0, 416.0, 416.0, 416.0, 9089.0, 416.0, 120158.0, 322884.0, 34422.0, 20770.0, 4992, 5970.0]
# action list :  dict_keys([4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 19, 30, 31, 32, 33, 34, 50, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 109, 110, 111, 112, 113, 115, 128, 129, 130, 149, 150, 151, 157, 158, 162, 169, 170, 193, 194, 195, 196, 209, 234, 251, 274, 275, 276])
# Average query cost: 354.6887742739451
# Environment adaption ratio: 0.9276018099547512， 205 221
# [0.8105392156862745, 0.22124697336561744, 0.28333178222429034, 0.16875691906401177, 0.2959667001578872, 0.29838393961696863, 0.17500658183413778, 0.11568135341141476, 0.22303888208339004, 0.17467767809399323, 0.09537914691943128, 0.06690391459074733, 0.04052886379508303, 0.034655021834061134, 0.02772401746724891, 0.3592738530819026, 0, 0, 0.001692047377326565, 0, 0, 0.016183557505574337, 0.024574411279718288, 0, 0.010634650497385201, 0.008289440328986283, 0.26938953448769126, 0.3636071629326267, 0.19479131237549197, 0.14228354801891407, 0.25062808979657997, -0.07722559885591705, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.024496058492441856, 0, 0.020942575458093908, 0.015820446406528094, 0.013636031914117245, 0.293868724427089, 0, 0.06529583146571044, 0, 0.05033217542336083, 0.039961789284451696, 0.03295230084042449, 0.0297796618009919, -0.14312218393851048, 0.04822883751870946, 0.03215255834580631, 0.02411441875935473, 0.032045478471418046, 0, 0.028213142247293793, 0.28495492583414145, 0.2108953341740227, 0.16394204411956664, 0.18212808459358817, 0.1325967884347735, 0.1729194843026001, 0.1585369405049652, 0.14401137684307458, 0.11703708150126807, 0.20848143912465614, 0.2241700957770617, 0.3195193542469272, 0.1285984032861828, 0.14076050700466977, 0.2917037138362629, 0, 0, 0, 0.075, 0.07673231218088986, 0.04342730120238456, 0.04495062061872646, 0.030321470333530668, 0.3105392897839585, 0.3422054630736687, 0.18194195284469503, 0.19112122525646583, 0.14481745007005303, 0.2991338615864452, 0.3554715307682433, 0.3631232964566298, 0.1099942561746123, 0.1531412376003779, 0.1643835616438356, 0, 0, 0, 0, 0, 0.013703943115707821, 0.024474510284193087, 0.022449995500157496, 0.017379792096080243, 0.009016413593044505, 0.19586252525371864, 0.18790074261909073, 0.28868345241776666, 0.3165580972579912, 0.34026741566458935, 0.04286187479297781, 0.1523581182707629, 0.046617655439676296, 0.03928820942752641, 0.0316162033041934, 0.03197427805490515, 0.025579422443924124, 0, -0.6433333333333333, -0.023177681381304754, 0.054508660457829226, 0.04541561116072242, 0.03118474527813666, 0.021071488918545187, 0.16538456879111293, 0.16425827693433329, 0.1620672255860891, 0.062229684106794164, 0.07417828313802191, 0.047693717689851214, 0.04148229068716928, 0.03084116107501927, 0.09778420038535646, 0.05218537118989608, 0.034790247459930715, 0.04287664432861752, 0.03430131546289402, 0, 0, 0, -0.04761114797611148, 0.03647217607973422, 0.027459640833376132, 0.02714723926380368, 0.024720579163189028, 0.2050938601847657, 0.1514059441181705, 0.1581049142919236, 0.05702343633378116, 0.025076076779026218, 0.04005395261552897, 0.03910725652450668, 0.03246318771214378, 0.24687416866187817, 0.2593984962406015, 0, 0, 0, 0.12324561403508771, 0, 0.0, 0.022849224600507104, 0.032308315144687745, 0.02492407898533797, 0.019501705472341688, 0.15581482289167886, 0.10543193717277487, 0.08554365009660987, 0.05061417196815108, 0.028577374693305294, 0, 0, 0, 0, 0, 0.01088019857708645, 0.009792178719377806, 0, -0.29469476744186046, -0.011970534069981584, -0.005820579615760339, 0.00888943458775861, 0.03277627814341896, 0.027373689973408416, 0.09616471253001836, 0.07451963572582324, 0.048252050064738886, 0.03986966311596086, 0.034565110794592194, 0.15564581640942324, 0.21608181647588665, 0.2195200688690412, 0.1850940975192472, 0.08928571428571429, 0.05106330365974283, 0.03404220243982855, 0.025531651829871414, 0.020425321463897132, 0, 0, 0.03900763619008659, 0.01691432014547176, 0.020848627862261843, 0.015576288617851564, 0.016967051708626554, 0.13411170088399604, 0.01651213126529995, 0, 0.0054090866608390645, 0.003891578243095946, 0.004174990693404404, 0.002723419559158738, 0.042132500122052434, 0.021483801507291768, 0.013806985265210486, 0.01025541495225526, 0.008204331961804208, 0, 0.07103311913000494, 0.05152791468769603, 0.008532423208191127, 0.006228782934361243, 0.008216953235687594, 0, 0.00546796908246984, 0, 0.0017811359527744525, 0.002267157065961801, 0.002401629076378196, 0.0019039927722329646, 0.10956122871000488, 0.09025901795645956, 0.04212794166390454, 0.013755912528848571, 0.010186584843083726, 0.011730168116921517, 0, 0, -0.22966507177033493, -0.1722488038277512, 0, 0, 0.00765149644310967, 0.006085175323531139, 0.00551449788407512, 0.007023443799181457, 0.00674251839044083, 0.14913537425224954, 0.04482868399060846, 0.0523929530359414, 0.04739659204438268, 0.03104909037670753, 0.024900187302839116, -0.35714285714285715, -0.018593904719991197, -0.012395936479994133, -0.009296952359995598, -0.007437561887996479, -0.006197968239997066, 0.036555360281195076, 0.033602449888641424, 0.04880707174733951, 0.026019674438528855, 0.016634764227100984, 0.06772178094881448, 0, 0.01368079166181083, 0.014016749108827449, 0.010426652825977075, 0.008740497103190826, 0.17554582497111232, 0.12131715771230503, 0.1, 0]

# env-mask
# The total reward : 18.656649614122642
# io_cost :  [70080, 15040.0, 55741.0, 68821.0, 44394.0, 130598.0, 60239.0, 24588.0, 46290.0, 19423.0, 28625.0, 23142.0, 60731.0, 66685.0, 59572.0, 40755.0, 70794.0, 39663.0, 22309.0, 51656.0, 48913.0, 100263.0, 46744.0, 70411.0, 71878.0, 132947.0, 24226.0, 1056.0, 538318.0, 208847.0, 270740.0, 253850.0, 278456.0, 273159.0, 203655.0, 67778.0, 115007.0, 57390.0, 66842.0, 832.0, 41576.0, 49087.0, 105353.0, 91579.0, 112282.0, 127936.0, 86124.0, 75874.0, 98456.0, 88473.0, 33201.0, 16136.0, 12313.0, 8152.0, 244066.0, 87233.0, 86079.0, 64801.0, 69562.0, 71334.0, 69935.0, 29469.0, 896.0, 165708.0, 85811.0, 69156.0, 106032.0, 236126.0, 28203.0, 800.0, 137785.0, 53263.0, 68580.0, 38155.0, 81902.0, 24186.0, 9472.0, 5610.0, 275155.0, 11302.0, 7928.0, 9271.0, 43794.0, 217189.0, 40489.0, 356247.0, 174922.0, 758334.0, 201380.0, 544.0, 67351.0, 302552.0, 126281.0, 320.0, 320.0, 320.0, 320.0, 17081.0, 320.0, 188136.0, 241923.0, 48649.0, 352.0, 320.0, 242696.0, 224036.0, 5520]
# action list :  dict_keys([4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 19, 27, 28, 29, 30, 31, 32, 33, 48, 49, 50, 68, 69, 70, 71, 72, 73, 74, 75, 76, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 109, 110, 111, 112, 113, 115, 128, 129, 130, 149, 150, 151, 157, 158, 162, 174, 175, 208])
# Average query cost: 352.1830454498252
# Environment adaption ratio: 0.9466666666666667， 213 225

# env-par-mask
# The total reward : 18.515162699584305
# io_cost :  [70080, 15040.0, 55741.0, 68821.0, 44394.0, 130598.0, 60239.0, 24588.0, 46290.0, 19423.0, 28625.0, 23142.0, 60731.0, 66685.0, 59572.0, 40755.0, 70794.0, 39663.0, 22309.0, 51656.0, 26886.0, 27163.0, 85027.0, 51600.0, 70411.0, 71878.0, 695491.0, 208847.0, 270740.0, 253850.0, 278456.0, 273159.0, 203655.0, 67778.0, 115007.0, 57390.0, 32875.0, 13240.0, 16061.0, 204389.0, 89170.0, 112282.0, 127936.0, 86124.0, 75874.0, 98456.0, 88473.0, 33201.0, 16136.0, 12313.0, 8152.0, 244066.0, 87233.0, 86079.0, 64801.0, 69562.0, 71334.0, 69935.0, 31869.0, 864.0, 23266.0, 39613.0, 48387.0, 80622.0, 87160.0, 69156.0, 106032.0, 236126.0, 28203.0, 800.0, 137785.0, 53263.0, 68580.0, 38155.0, 81902.0, 280982.0, 16497.0, 37917.0, 320.0, 28059.0, 12611.0, 907824.0, 233898.0, 595961.0, 27132.0, 362107.0, 44584.0, 178809.0, 373343.0, 43186.0, 512.0, 14693.0, 131484.0, 57304.0, 278846.0, 33465.0, 20770.0, 10290.0]
# action list :  dict_keys([4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 19, 27, 28, 29, 30, 31, 32, 33, 34, 36, 48, 49, 50, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 109, 110, 111, 112, 113, 115, 124, 125, 126, 127, 128, 129, 130, 149, 150, 151, 172, 187, 210, 225, 232, 255, 268, 274, 275])
# Average query cost: 356.0716189553117


# Environment adaption ratio: 0.33261802575107297， 155 466
# [0.7917043740573152, 0, 0.1967265215318608, 0.36183418418693164, 0.18727985315275092, 0.25198853312876, 0.22385343001223407, 0.20537558534864328, 0.3509778656358461, 0.5349901994151945, 0.39154655529254295, 0.18807201045961983, 0.23724714878598738, 0.3497521086858541, 0.4154893593982113, 0.11185171316232916, 0, 0.24458962841976317, 0, 0, 0, 0, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, 0.21453191016233045, -0.001, 0.11333507762079191, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, 0.24718323779403045, 0.26429789591457653, 0.26793236601919024, 0.19389625035241048, 0.29619250357036997, 0.24241006888340846, -0.001, 0.11329253234551995, 0, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, 0.23147193414515677, 0.2083452143332383, 0.3059023914506669, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, 0, 0, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, 0.1046892773753218, 0.20140958854500376, 0.26908655267375103, 0.17529784491585657, 0.16170777242802398, 0.1848596468944494, 0.17477900508957975, 0.19951694435241688, 0.24106043412125455, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, 0.39945481232962887, 0.3593604437030136, 0.15956751534439645, 0.22742719333503855, 0.18949525322211042, 0.13521366309970945, 0.1428603869561268, 0.21925507900677202, 0.2174446261334919, 0.21219638625592416, 0.2353833033260684, 0.23919336798473584, 0, 0, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, 0.2275661558172769, 0.170781547419102, 0.28712028712028714, 0.20494837327099164, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, 0.2305002967205924, 0.13855718810030632, 0.1941150885951476, 0.2697479121320181, 0.22925844346549193, 0.18752292542535481, 0.22595048031389528, 0.16257758717977655, 0.29773975496408955, 0.3260318049625642, 0, 0, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, 0.20682169282055451, 0.2515376529265729, 0.13364292103610376, 0.2653557224922669, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, 0.24675324675324675, 0.13836700933475127, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, 0, -0.001, -0.001, -0.001, 0.20665006226650062, 0.252111834166037, 0.19530339880234626, 0.19502509514091887, 0.20646278569661447, 0.2681781510519021, 0.2259837654728679, 0.336836058926882, 0.1378543177323665, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, 0.22439102223167748, 0.2831172898997687, 0.23062508505804885, 0.1965855850073808, 0.20795694068051793, 0.17666431427899318, -0.001, 0, 0, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, 0.28158394358557093, 0.17815908717621712, 0.20069214940450208, 0.19254850982122626, 0.17742254531068416, 0.1764090793165009, 0.127831023747024, 0.13317572892040977, 0.16212456528612076, 0.31812865497076026, 0, 0, 0, 0, 0, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, 0.24199885318665448, 0.17222304538944042, 0.14688664183076106, 0, 0.1405408604059412, 0.2629179331306991, 0, 0, 0, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, 0.24640203952959236, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, 0.1647042855688643, 0.2337087928289202, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, 0.31747490358241787, 0.4088935267782004, 0.13793711301588701, 0.15091107078039928, 0.19484248754258043, 0.14081442624159898, 0.15923113431419078, 0.3042302709401228, 0.23890897977894363, 0.1745418193935355, -0.001, 0.13148956817079088, -0.001, 0.1820643797613281, 0, 0, 0, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, 0.26953136021217167, 0.2823802016148297, 0.2185466377440347, 0.11900215583615645, 0.3139160180457092, -0.001, -0.001, 0.11037942928817811, 0, 0, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, 0.16390214013742396, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, 0.3519491291125242, 0.15966793649395547, 0.338954833768958, 0.2260521908260846, 0.2164071856287425, 0.25002143604342086, 0.20992898602419016, 0.29655524694314084, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, 0, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, 0.27646418293536595, 0.2543970377850711, 0.224, -0.001, 0, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, 0.17346526175582141, 0.29713390412584867, 0.1243327691706809, 0.20252138795897762, 0.27705439073153226, 0.18597168597168598, 0.1307885331913923, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, 0.348356513787959, 0.1801930639971398, 0.30067752834828143, 0.3127713472273077, 0.18357639597494546, 0.20907994893858448, 0.38973982207599306, 0.15803640889995332, 0.2719841044564292, 0.12730276051290665, -0.001, 0.12942243417298444, 0.2445961995249406, 0.23947705716482953, 0, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, -0.001, 0.24881193185972267, 0.2937799043062201, 0.2714625445897741, -0.001, -0.001, -0.001, -0.001, -0.001, 0]

# reward_threshold=0 （No skew degree）

