from stable_baselines3 import PPO
from controller.environment.env_v3 import Env3
from controller.baselines.after_all import Afterall
class PpoControllerV3(Afterall):

    def repartition(self, initial_par, wLoad):
        env = Env3()
        # 预训练模型
        # pretrained = PPO("MlpPolicy", env, verbose=1,tensorboard_log="./stable_pretrained_model/ppo_controller_tensorboard/")
        # # Run Command: tensorboard --logdir ./stable_pretrained_model/ppo_controller_tensorboard/
        # pretrained.learn(total_timesteps=2e5)
        # # # Save the agent
        # pretrained.save("stable_pretrained_model/ppo_controller_v3")
        # del pretrained
        model = PPO.load("stable_pretrained_model/ppo_controller_v3")

        # 微调过程
        # pretrained = PPO.load("stable_pretrained_model/ppo_controller_v3",env=env)
        # pretrained.learn(total_timesteps=1e4)
        # pretrained.save("stable_pretrained_model/ppo_controller_v3_tune")
        # del pretrained
        # pretrained = PPO.load("stable_pretrained_model/ppo_controller_v3_tune")

        obs = env.reset()
        epoch = 0
        total_reward = []
        for i in range(2000):
            action, _states = model.predict(obs, deterministic=True)
            obs, reward, done, info = env.step(action)
            total_reward.append(reward)
            if done:
                self.action_list=env.action_list
                self.cost_list=env.cost_list
                print(f"The total reward : {sum(total_reward)}")
                print('io_cost : ', env.io_cost)
                print('action list : ', env.action_list)
                print(
                    f"Average query cost: {sum(env.io_cost) / sum([sql['feature'].frequency for sql in env.w.sql_list])}")
                epoch += 1
                obs = env.reset()
                if epoch == 1: break

        env.close()

        # 10000query-steam.csv (time range: 0-1500)
        # 预训练模型
        # reward_threshold=0  reward>0 or operation_cost==0
        # 训练模型奖励：
        # steps:2e5
        # The total reward : 21.459836612735153
        # io_cost :  [78240, 7380.0, 18155.0, 256.0, 532062.0, 96.0, 433617.0, 384.0, 435432.0, 149472.0, 21936.0, 192.0, 352.0, 1045483.0, 256.0, 128.0, 160.0, 160.0, 64.0, 160.0, 36520.0, 160.0, 192.0, 37376.0, 128.0, 51397.0, 160.0, 53633.0, 11786.0, 38011.0, 256.0, 41716.0, 416.0, 416.0, 384.0, 22116.0, 288.0, 288.0, 128.0, 18534.0, 128.0, 34441.0, 36528.0, 320.0, 81858.0, 288.0, 51846.0, 352.0, 224.0, 288.0, 288.0, 320.0, 44785.0, 448.0, 448.0, 23160.0, 160.0, 160.0, 95385.0, 288.0, 36809.0, 128.0, 65006.0, 384.0, 160.0, 320.0, 448.0, 448.0, 192.0, 47528.0, 320.0, 320.0, 256.0, 160.0, 160.0, 57750.0, 192.0, 58836.0, 128.0, 70235.0, 1280.0, 46226.0, 352.0, 1280.0, 1600.0, 512.0, 20292.0, 320.0, 320.0, 19558.0, 224.0, 52918.0, 25299.0, 160.0, 73889.0, 31208.0, 33047.0, 18676.0, 128.0, 24782.0, 64.0, 160.0, 160.0, 64.0, 9555.0, 72136.0, 19319.0, 29155.0, 29767.0, 42765.0, 25437.0, 16413.0, 15026.0, 64.0, 15664.0, 256.0, 19488.0, 256.0, 10693.0, 256.0, 18767.0, 256.0, 50871.0, 60124.0, 26114.0, 64.0, 97282.0, 288.0, 352.0, 25053.0, 384.0, 352.0, 320.0, 320.0, 320.0, 288.0, 22610.0, 448.0, 38291.0, 288.0, 57323.0, 38286.0, 30272.0, 20910.0, 13167.0, 21402.0, 64.0, 224.0, 320.0, 20763.0, 192.0, 192.0, 128.0, 18092.0, 41376.0, 41101.0, 23967.0, 19457.0, 1376.0, 51302.0, 320.0, 46882.0, 480.0, 256.0, 58620.0, 61238.0, 192.0, 76823.0, 224.0, 51104.0, 224.0, 288.0, 69639.0, 352.0, 7934.0, 352.0, 43206.0, 48736.0, 416.0, 68608.0, 35404.0, 12005.0, 21074.0, 29354.0, 320.0, 384.0, 256.0, 256.0, 256.0, 256.0, 16819.0, 13819.0, 19922.0, 29154.0, 35892.0, 29255.0, 32268.0, 42805.0, 1280.0, 320.0, 224.0, 224.0, 224.0, 77979.0, 416.0, 352.0, 256.0, 256.0, 27075.0, 64.0, 40992.0, 288.0, 57002.0, 224.0, 94677.0, 192.0, 32257.0, 480.0, 38464.0, 416.0, 10729.0, 128.0, 11280, 192.0, 2514.0, 96.0, 79968.0, 352.0, 59052.0, 96.0, 28636.0, 224.0, 45990.0, 128.0, 128.0, 128.0, 128.0, 40816.0, 352.0, 352.0, 192.0, 33708.0, 29427.0, 26953.0, 30305.0, 41016.0, 35788.0, 11124.0, 27057.0, 12081.0, 416.0, 18940.0, 8432.0, 64.0, 64.0, 6750.0, 22672.0, 13298.0, 16028.0, 128.0, 49097.0, 115001.0, 320.0, 28838.0, 416.0, 11154.0, 6945.0, 224.0, 24681.0, 416.0, 25670.0, 53199.0, 256.0, 97905.0, 192.0, 192.0, 40051.0, 256.0, 64.0, 6645.0, 16233.0, 74172.0, 192.0, 84081.0, 27972.0, 47098.0, 256.0, 22395.0, 10924.0, 19463.0, 352.0, 64583.0, 25803.0, 31609.0, 28535.0, 49792.0, 288.0, 384.0, 224.0, 192.0, 51911.0, 4974.0, 4814.0, 15202.0, 39683.0, 27855.0, 24342.0, 55183.0, 288.0, 59286.0, 224.0, 28659.0, 352.0, 34294.0, 96.0, 96.0, 145712.0, 416.0, 544.0, 79390.0, 224.0, 160.0, 17370.0, 288.0, 288.0, 288.0, 224.0, 256.0, 192.0, 72369.0, 416.0, 33767.0, 72627.0, 64316.0, 20702.0, 224.0, 384.0, 19776.0, 352.0, 288.0, 14248.0, 55401.0, 64.0, 69684.0, 34332.0, 29748.0, 29779.0, 15221.0, 352.0, 21879.0, 416.0, 17000.0, 2074.0, 4404.0, 27363.0, 256.0, 69932.0, 320.0, 74644.0, 96.0, 64272.0, 352.0, 160.0, 576.0, 35577.0, 66485.0, 23917.0, 64403.0, 224.0, 49532.0, 160.0, 31345.0, 448.0, 384.0, 320.0, 320.0, 320.0, 19352.0, 320.0, 17087.0, 64.0, 69544.0, 43828.0, 32918.0, 384.0, 41777.0, 512.0, 21231.0, 320.0, 70976.0, 160.0, 85272.0, 192.0, 48669.0, 192.0, 33131.0, 384.0, 480.0, 480.0, 384.0, 21424.0, 224.0, 224.0, 224.0, 352.0, 16664.0, 512.0, 39602.0, 29274.0, 33522.0, 47980.0, 27936.0, 32193.0, 320.0, 224.0, 224.0, 224.0, 35675.0, 224.0, 26780.0, 352.0, 192.0, 74522.0, 52056.0, 19544.0, 43500.0, 6086.0, 160.0, 44051.0, 416.0, 14740.0, 256.0, 160.0, 4657.0, 20724.0, 320.0, 16118.0, 384.0, 62188.0, 69907.0, 224.0, 66754.0, 40690.0, 448.0, 19525.0, 288.0, 36722.0, 19455.0, 192.0, 47904.0, 192.0, 65371.0, 352.0, 62721.0, 544.0, 25729.0, 576.0, 448.0, 448.0, 20536.0, 192.0, 128.0, 45277.0, 192.0, 44454.0, 160.0, 49632.0, 64.0, 448.0, 86257.0, 480.0, 384.0, 608.0, 608.0, 13740.0, 160.0, 96.0, 224.0, 39154.0, 51962.0, 32813.0, 45465.0, 19373.0, 47547.0, 288.0, 58513.0, 7787.0, 8714.0, 64.0, 128.0, 192.0, 39646.0, 192.0, 90165.0, 352.0, 66640.0, 320.0, 24354.0, 96.0, 224.0, 23191.0, 25034.0, 320.0, 40562.0, 256.0, 288.0, 92671.0, 160.0, 608.0, 119469.0, 672.0, 3744.0, 128.0, 15438.0, 21772.0, 19548.0, 45997.0, 33135.0, 192.0, 71173.0, 24328.0, 288.0, 33358.0, 7231.0, 256.0, 192.0, 192.0, 128.0, 128.0, 19626.0, 36211.0, 224.0, 106632.0, 19800.0, 25187.0, 20676.0, 160.0, 224.0, 608.0, 480.0, 65219.0, 10680.0, 25791.0, 53157.0, 256.0, 63856.0, 192.0, 71463.0, 160.0, 1344.0, 448.0, 448.0, 192.0, 65661.0, 576.0, 576.0, 576.0, 576.0, 72650.0, 21307.0, 19860.0, 74470.0, 160.0, 256.0, 192.0, 448.0, 256.0, 88815.0, 60777.0, 74258.0, 32547.0, 27588.0, 28860.0, 256.0, 17820.0, 192.0, 21212.0, 160.0, 64.0, 16036.0, 256.0, 16272.0, 160.0, 30015.0, 25569.0, 160.0, 64291.0, 448.0, 77207.0, 416.0, 28393.0, 13494.0, 384.0, 288.0, 1600.0, 19662.0, 256.0, 256.0, 11942.0, 320.0, 54475.0, 256.0, 70457.0, 64.0, 72893.0, 256.0, 51738.0, 384.0, 7182.0, 19938.0, 384.0, 512.0, 512.0, 14371.0, 224.0, 19512.0, 44887.0, 33582.0, 160.0, 43450.0, 64.0, 72078.0, 160.0, 25386.0, 128.0, 352.0, 480.0, 74044.0, 52982.0, 160.0, 39452.0, 384.0, 192.0, 192.0, 192.0, 160925.0, 256.0, 128.0, 128.0, 128.0, 11904, 256.0, 14128.0, 320.0, 15704.0, 27961.0, 160.0, 39627.0, 288.0, 52302.0, 46867.0, 320.0, 320.0, 160.0, 32875.0, 320.0, 320.0, 320.0, 320.0, 320.0, 320.0, 256.0, 160.0, 110385.0, 29149.0, 28418.0, 49967.0, 256.0, 40811.0, 352.0, 480.0, 352.0, 448.0, 352.0, 352.0, 30806.0, 13000.0, 480.0, 41456.0, 35083.0, 43618.0, 51918.0, 20258.0, 28962.0, 416.0, 288.0, 512.0, 416.0, 320.0, 39110.0, 352.0, 288.0, 256.0, 62691.0, 12275.0, 48510.0, 29673.0, 64.0, 74987.0, 512.0, 480.0, 480.0, 35413.0, 352.0, 352.0, 224.0, 16711.0, 33184.0, 29940.0, 38602.0, 22000.0, 26945.0, 32767.0, 416.0, 48139.0, 416.0, 608.0, 608.0, 16825.0, 64.0, 8549.0, 96.0, 55011.0, 38305.0, 39845.0, 28481.0, 22139.0, 37008.0, 26316.0, 9040.0, 128.0, 288.0, 10643.0, 256.0, 256.0, 9898.0, 224.0, 224.0, 38310.0, 256.0, 79131.0, 23361.0, 70206.0, 288.0, 288.0, 352.0, 61415.0, 288.0, 224.0, 224.0, 288.0, 12086.0, 1482.0, 64.0, 15118.0, 42423.0, 30167.0, 40969.0, 53491.0, 21252.0, 288.0, 26006.0, 288.0, 64.0, 160.0, 320.0, 128.0, 16536.0, 320.0, 23317.0, 32406.0, 12605.0, 31177.0, 64188.0, 64.0, 42194.0, 160.0, 96.0, 96.0, 37127.0, 3035.0, 29628.0, 29574.0, 37329.0, 384.0, 58829.0, 256.0, 57035.0, 31639.0, 256.0, 352.0, 192.0, 320.0, 288.0, 320.0, 13207.0, 288.0, 352.0, 19625.0, 10664.0, 19144.0, 29630.0, 32437.0, 38774.0, 73089.0, 224.0, 320.0, 20947.0, 224.0, 160.0, 160.0, 160.0, 160.0, 160.0, 96.0, 47035.0, 160.0, 81924.0, 47821.0, 55773.0, 416.0, 26078.0, 15174.0, 14992.0, 256.0, 2332.0, 128.0, 10227.0, 22477.0, 28345.0, 81950.0, 1184.0, 66971.0, 61713.0, 160.0, 320.0, 320.0, 320.0, 224.0, 128.0, 23362.0, 192.0, 320.0, 88978.0, 352.0, 224.0, 119629.0, 1504.0, 384.0, 384.0, 288.0, 256.0, 43836.0, 320.0, 12181.0, 53040.0, 288.0, 67600.0, 46314.0, 70570.0, 128.0, 160.0, 64.0, 384.0, 448.0, 44331.0, 320.0, 320.0, 256.0, 384.0, 31605.0, 22461.0, 61996.0, 45545.0, 24538.0, 15826.0, 256.0, 64.0, 48027.0, 256.0, 192.0, 21574.0, 256.0, 256.0, 256.0, 128.0, 224.0, 38116.0, 288.0, 128.0, 60817.0, 32837.0, 54603.0, 27436.0, 256.0, 96.0, 50159.0, 512.0, 512.0, 512.0, 448.0, 416.0, 416.0, 15912.0, 288.0, 23821.0, 256.0, 26756.0, 32022.0, 50545.0, 27736.0, 46580.0, 28117.0, 288.0, 26972.0, 192.0, 96.0, 224.0, 192.0, 64.0, 22139.0, 256.0, 256.0, 3864.0, 224.0, 28618.0, 128.0, 160.0, 78641.0, 352.0, 192.0, 113781.0, 480.0, 352.0, 480.0, 35938.0, 128.0, 160.0, 8592, 64.0, 11281.0, 13984.0, 32723.0, 35780.0, 320.0, 80085.0, 448.0, 36964.0, 64.0, 26678.0, 14439.0, 320.0, 320.0, 22870.0, 224.0, 13205.0, 96.0, 23868.0, 20875.0, 25908.0, 18812.0, 45475.0, 25679.0, 96.0, 38563.0, 160.0, 512.0, 512.0, 37422.0, 52810.0, 288.0, 64718.0, 28041.0, 36356.0, 53461.0, 9449.0, 14335.0, 8423.0, 8475.0, 160.0, 160.0, 6959.0, 224.0, 17815.0, 160.0, 20923.0, 43481.0, 35148.0, 55040.0, 24683.0, 288.0, 20011.0, 64.0, 128.0, 29408.0, 320.0, 224.0, 9712.0, 224.0, 10694.0, 8496, 16574.0, 128.0, 50349.0, 41053.0, 43611.0, 448.0, 42902.0, 18422.0, 352.0, 480.0, 22006.0, 3552.0, 128.0, 19601.0, 24506.0, 384.0, 127300.0, 24992.0, 23230.0, 36739.0, 416.0, 17013.0, 53901.0, 7938.0, 27284.0, 45042.0, 40864.0, 28188.0, 25814.0, 160.0, 224.0, 384.0, 224.0, 47063.0, 320.0, 384.0, 320.0, 320.0, 224.0, 256.0, 36238.0, 27620.0, 29849.0, 58743.0, 17532.0, 57084.0, 352.0, 82315.0, 53613.0, 224.0, 87308.0, 224.0, 30627.0, 96.0, 23619.0, 12836.0]
        # action list :  [[3, 1], [4, 1], [5, 1], [6, 0], [7, 1], [8, 0], [9, 1], [10, 0], [11, 1], [12, 1], [14, 1], [15, 0], [16, 0], [55, 1], [56, 0], [57, 0], [59, 0], [60, 0], [61, 0], [62, 0], [63, 1], [64, 0], [65, 0], [66, 1], [67, 0], [68, 1], [69, 0], [70, 1], [71, 1], [72, 1], [73, 0], [74, 1], [76, 0], [77, 0], [78, 0], [79, 1], [82, 0], [83, 0], [84, 0], [85, 1], [86, 0], [87, 1], [88, 1], [89, 0], [90, 1], [91, 0], [92, 1], [93, 0], [94, 0], [95, 0], [96, 0], [97, 0], [98, 1], [103, 0], [104, 0], [105, 1], [106, 0], [107, 0], [108, 1], [109, 0], [110, 1], [111, 0], [112, 1], [113, 0], [114, 0], [115, 0], [116, 0], [117, 0], [118, 0], [119, 1], [122, 0], [123, 0], [124, 0], [125, 0], [126, 0], [127, 1], [128, 0], [129, 1], [131, 0], [132, 1], [134, 0], [135, 1], [136, 0], [137, 0], [138, 0], [139, 0], [140, 1], [143, 0], [144, 0], [145, 1], [146, 0], [147, 1], [148, 1], [149, 0], [150, 1], [151, 1], [152, 1], [153, 1], [154, 0], [156, 1], [157, 0], [159, 0], [160, 0], [161, 0], [162, 1], [167, 1], [168, 1], [169, 1], [170, 1], [171, 1], [172, 1], [173, 1], [174, 1], [175, 0], [176, 1], [180, 0], [181, 1], [183, 0], [184, 1], [185, 0], [186, 1], [187, 0], [188, 1], [189, 1], [190, 1], [192, 0], [193, 1], [194, 0], [195, 0], [196, 1], [198, 0], [200, 0], [201, 0], [202, 0], [203, 0], [204, 0], [205, 1], [206, 0], [207, 1], [208, 0], [209, 1], [210, 1], [211, 1], [212, 1], [213, 1], [214, 1], [216, 0], [217, 0], [218, 0], [219, 1], [222, 0], [223, 0], [224, 0], [225, 1], [226, 1], [227, 1], [228, 1], [229, 1], [230, 0], [231, 1], [232, 0], [233, 1], [234, 0], [235, 0], [246, 1], [248, 1], [249, 0], [250, 1], [251, 0], [252, 1], [253, 0], [254, 0], [255, 1], [257, 0], [260, 1], [264, 0], [267, 1], [268, 1], [269, 0], [270, 1], [271, 1], [272, 1], [273, 1], [276, 1], [277, 0], [280, 0], [281, 0], [282, 0], [283, 0], [284, 0], [285, 1], [286, 1], [287, 1], [288, 1], [289, 1], [290, 1], [291, 1], [292, 1], [294, 0], [295, 0], [296, 0], [297, 0], [298, 0], [299, 1], [301, 0], [302, 0], [303, 0], [304, 0], [305, 1], [306, 0], [307, 1], [308, 0], [309, 1], [310, 0], [311, 1], [312, 0], [313, 1], [314, 0], [315, 1], [316, 0], [317, 1], [318, 0], [319, 1], [321, 0], [322, 1], [323, 0], [327, 1], [328, 0], [329, 1], [330, 0], [331, 1], [332, 0], [333, 1], [335, 0], [336, 0], [337, 0], [338, 0], [339, 1], [343, 0], [344, 0], [345, 0], [346, 1], [347, 1], [348, 1], [349, 1], [350, 1], [351, 1], [352, 1], [353, 1], [354, 1], [355, 0], [356, 1], [358, 1], [361, 0], [362, 0], [363, 1], [365, 1], [366, 1], [367, 1], [368, 0], [369, 1], [372, 1], [373, 0], [374, 1], [375, 0], [376, 1], [380, 1], [383, 0], [384, 1], [385, 0], [386, 1], [388, 1], [389, 0], [392, 1], [393, 0], [394, 0], [395, 1], [396, 0], [397, 0], [400, 1], [405, 1], [407, 1], [408, 0], [410, 1], [411, 1], [413, 1], [415, 0], [416, 1], [420, 1], [424, 1], [425, 0], [427, 1], [428, 1], [429, 1], [430, 1], [432, 1], [433, 0], [434, 0], [435, 0], [436, 0], [438, 1], [443, 1], [444, 1], [445, 1], [446, 1], [447, 1], [448, 1], [449, 1], [450, 0], [451, 1], [452, 0], [453, 1], [454, 0], [466, 1], [467, 0], [469, 0], [470, 1], [471, 0], [472, 0], [473, 1], [474, 0], [475, 0], [476, 1], [480, 0], [481, 0], [482, 0], [483, 0], [484, 0], [485, 0], [487, 1], [488, 0], [489, 1], [491, 1], [493, 1], [495, 1], [496, 0], [499, 0], [500, 1], [503, 0], [504, 0], [505, 1], [507, 1], [508, 0], [509, 1], [510, 1], [511, 1], [512, 1], [513, 1], [514, 0], [515, 1], [516, 0], [519, 1], [523, 1], [524, 1], [526, 1], [527, 0], [528, 1], [529, 0], [530, 1], [531, 0], [532, 1], [533, 0], [534, 0], [535, 0], [538, 1], [547, 1], [548, 1], [550, 1], [551, 0], [552, 1], [553, 0], [555, 1], [559, 0], [560, 0], [561, 0], [562, 0], [563, 0], [564, 1], [565, 0], [566, 1], [567, 0], [568, 1], [569, 1], [570, 1], [571, 0], [572, 1], [573, 0], [574, 1], [575, 0], [587, 1], [588, 0], [590, 1], [591, 0], [592, 1], [593, 0], [594, 1], [596, 0], [597, 0], [598, 0], [599, 0], [600, 1], [601, 0], [602, 0], [603, 0], [604, 0], [605, 1], [606, 0], [607, 1], [608, 1], [609, 1], [610, 1], [611, 1], [613, 1], [614, 0], [616, 0], [617, 0], [618, 0], [619, 1], [624, 0], [625, 1], [626, 0], [627, 0], [628, 1], [629, 1], [630, 1], [631, 1], [632, 1], [633, 0], [635, 1], [636, 0], [638, 1], [640, 0], [641, 0], [642, 1], [644, 1], [645, 0], [646, 1], [647, 0], [648, 1], [650, 1], [651, 0], [652, 1], [654, 1], [655, 0], [656, 1], [657, 0], [664, 1], [666, 1], [667, 0], [668, 1], [669, 0], [670, 1], [671, 0], [672, 1], [673, 0], [674, 1], [675, 0], [676, 0], [679, 0], [680, 1], [684, 0], [685, 0], [686, 1], [687, 0], [688, 1], [689, 0], [690, 1], [691, 0], [693, 0], [694, 1], [695, 0], [696, 0], [697, 0], [698, 0], [699, 1], [703, 0], [704, 0], [705, 0], [706, 1], [708, 1], [709, 1], [710, 1], [711, 1], [713, 1], [714, 0], [717, 1], [722, 1], [723, 1], [724, 0], [725, 0], [726, 0], [727, 1], [728, 0], [729, 1], [730, 0], [732, 1], [733, 0], [734, 1], [735, 0], [736, 0], [739, 1], [745, 1], [746, 0], [747, 1], [748, 0], [749, 0], [750, 1], [751, 0], [756, 0], [757, 1], [761, 0], [762, 1], [764, 0], [765, 1], [766, 1], [767, 1], [768, 1], [769, 1], [770, 0], [771, 1], [772, 1], [773, 0], [774, 1], [776, 1], [780, 0], [781, 0], [782, 0], [783, 0], [784, 0], [785, 1], [787, 1], [788, 0], [789, 1], [790, 1], [791, 1], [792, 1], [793, 0], [794, 0], [797, 0], [798, 0], [799, 1], [804, 1], [805, 1], [807, 1], [808, 0], [809, 1], [810, 0], [811, 1], [812, 0], [813, 0], [816, 0], [817, 0], [818, 0], [819, 1], [820, 0], [822, 0], [823, 0], [824, 0], [827, 1], [828, 1], [829, 1], [832, 1], [833, 0], [834, 0], [835, 0], [836, 0], [837, 0], [838, 1], [847, 1], [849, 1], [850, 1], [851, 1], [852, 1], [853, 0], [854, 1], [855, 0], [856, 1], [860, 0], [861, 0], [862, 1], [864, 0], [865, 1], [866, 0], [867, 1], [868, 1], [869, 0], [870, 1], [871, 0], [872, 1], [873, 0], [874, 1], [875, 1], [876, 0], [877, 0], [879, 0], [880, 1], [883, 0], [884, 0], [885, 1], [886, 0], [887, 1], [888, 0], [889, 1], [890, 0], [891, 1], [892, 0], [893, 1], [894, 0], [895, 1], [899, 1], [901, 0], [902, 0], [903, 0], [904, 1], [905, 0], [906, 1], [907, 1], [908, 1], [909, 0], [910, 1], [911, 0], [912, 1], [913, 0], [914, 1], [915, 0], [916, 0], [917, 0], [925, 1], [927, 1], [928, 0], [929, 1], [930, 0], [933, 0], [934, 0], [935, 0], [936, 1], [937, 0], [939, 0], [940, 0], [941, 0], [942, 1], [943, 0], [944, 1], [945, 0], [946, 1], [947, 1], [948, 0], [949, 1], [950, 0], [951, 1], [953, 1], [954, 0], [955, 0], [956, 0], [957, 1], [959, 0], [960, 0], [961, 0], [962, 0], [963, 0], [964, 0], [965, 0], [966, 0], [968, 1], [969, 1], [970, 1], [972, 1], [973, 0], [974, 1], [975, 0], [979, 0], [980, 0], [981, 0], [982, 0], [983, 0], [984, 1], [985, 1], [986, 0], [987, 1], [988, 1], [989, 1], [990, 1], [991, 1], [993, 1], [994, 0], [995, 0], [996, 0], [997, 0], [998, 0], [1002, 1], [1004, 0], [1005, 0], [1006, 0], [1007, 1], [1008, 1], [1009, 1], [1010, 1], [1011, 0], [1013, 1], [1014, 0], [1017, 0], [1018, 0], [1019, 1], [1022, 0], [1023, 0], [1024, 0], [1025, 1], [1026, 1], [1027, 1], [1028, 1], [1029, 1], [1030, 1], [1031, 1], [1033, 0], [1035, 1], [1036, 0], [1039, 0], [1040, 0], [1041, 1], [1042, 0], [1043, 1], [1044, 0], [1047, 1], [1048, 1], [1049, 1], [1050, 1], [1051, 1], [1052, 1], [1053, 1], [1055, 1], [1056, 0], [1057, 0], [1058, 1], [1060, 0], [1061, 0], [1062, 1], [1063, 0], [1064, 0], [1065, 1], [1067, 0], [1068, 1], [1069, 1], [1071, 1], [1072, 0], [1073, 0], [1076, 0], [1077, 1], [1078, 0], [1080, 0], [1081, 0], [1082, 0], [1083, 1], [1084, 1], [1085, 0], [1086, 1], [1087, 1], [1088, 1], [1089, 1], [1090, 1], [1091, 1], [1092, 0], [1093, 1], [1094, 0], [1095, 0], [1096, 0], [1099, 0], [1100, 0], [1101, 1], [1105, 0], [1106, 1], [1107, 1], [1108, 1], [1109, 1], [1111, 1], [1112, 0], [1113, 1], [1114, 0], [1115, 0], [1116, 0], [1117, 1], [1121, 1], [1126, 1], [1127, 1], [1128, 1], [1129, 0], [1130, 1], [1131, 0], [1132, 1], [1134, 1], [1135, 0], [1136, 0], [1137, 0], [1139, 0], [1140, 0], [1141, 0], [1142, 1], [1143, 0], [1144, 0], [1145, 1], [1146, 1], [1147, 1], [1148, 1], [1149, 1], [1150, 1], [1152, 1], [1153, 0], [1155, 0], [1156, 1], [1158, 0], [1159, 0], [1160, 0], [1161, 0], [1162, 0], [1163, 0], [1164, 0], [1166, 1], [1167, 0], [1168, 1], [1169, 1], [1171, 1], [1172, 0], [1173, 1], [1174, 1], [1176, 1], [1180, 0], [1181, 1], [1184, 0], [1185, 1], [1186, 1], [1187, 1], [1189, 1], [1190, 0], [1191, 1], [1193, 1], [1194, 0], [1196, 0], [1197, 0], [1198, 0], [1199, 0], [1200, 0], [1201, 1], [1207, 0], [1208, 0], [1209, 1], [1210, 0], [1211, 0], [1213, 1], [1214, 0], [1215, 0], [1216, 0], [1217, 0], [1218, 0], [1219, 1], [1224, 0], [1225, 1], [1227, 1], [1228, 0], [1229, 1], [1230, 1], [1232, 1], [1233, 0], [1234, 0], [1235, 0], [1236, 0], [1237, 0], [1238, 1], [1241, 0], [1242, 0], [1243, 0], [1244, 0], [1245, 1], [1246, 1], [1248, 1], [1249, 1], [1250, 1], [1251, 1], [1252, 0], [1253, 0], [1254, 1], [1255, 0], [1256, 0], [1257, 1], [1261, 0], [1262, 0], [1263, 0], [1264, 0], [1265, 0], [1266, 1], [1267, 0], [1268, 0], [1269, 1], [1270, 1], [1271, 1], [1272, 1], [1273, 0], [1274, 0], [1275, 1], [1276, 0], [1277, 0], [1279, 0], [1280, 0], [1281, 0], [1282, 0], [1283, 1], [1284, 0], [1285, 1], [1286, 0], [1287, 1], [1288, 1], [1289, 1], [1290, 1], [1291, 1], [1292, 1], [1293, 0], [1294, 1], [1295, 0], [1296, 0], [1297, 0], [1298, 0], [1299, 0], [1300, 1], [1302, 0], [1303, 0], [1304, 1], [1305, 0], [1307, 1], [1308, 0], [1309, 0], [1310, 1], [1311, 0], [1313, 0], [1314, 1], [1315, 0], [1316, 0], [1317, 0], [1318, 1], [1321, 0], [1322, 0], [1323, 1], [1324, 0], [1325, 1], [1326, 1], [1327, 1], [1328, 1], [1329, 0], [1330, 1], [1331, 0], [1332, 1], [1333, 0], [1334, 1], [1335, 1], [1338, 0], [1339, 0], [1340, 1], [1342, 0], [1343, 1], [1345, 0], [1346, 1], [1347, 1], [1348, 1], [1349, 1], [1350, 1], [1351, 1], [1352, 0], [1353, 1], [1354, 0], [1357, 0], [1358, 0], [1359, 1], [1367, 1], [1368, 0], [1369, 1], [1370, 1], [1371, 1], [1372, 1], [1373, 1], [1374, 1], [1375, 1], [1377, 1], [1381, 0], [1382, 0], [1383, 1], [1384, 0], [1385, 1], [1386, 0], [1387, 1], [1388, 1], [1389, 1], [1390, 1], [1391, 1], [1392, 0], [1393, 1], [1394, 0], [1395, 0], [1396, 1], [1397, 0], [1400, 0], [1401, 1], [1403, 0], [1404, 1], [1405, 1], [1406, 1], [1407, 0], [1408, 1], [1409, 1], [1410, 1], [1411, 0], [1412, 1], [1413, 1], [1414, 0], [1415, 0], [1418, 1], [1422, 1], [1425, 0], [1426, 1], [1427, 1], [1428, 0], [1430, 1], [1431, 1], [1432, 1], [1434, 1], [1435, 0], [1439, 1], [1446, 1], [1447, 1], [1448, 1], [1449, 1], [1450, 1], [1451, 1], [1452, 1], [1454, 0], [1455, 0], [1456, 0], [1457, 0], [1458, 1], [1460, 0], [1461, 0], [1462, 0], [1463, 0], [1464, 0], [1465, 0], [1466, 1], [1467, 1], [1468, 1], [1469, 1], [1470, 1], [1472, 1], [1473, 0], [1487, 1], [1489, 1], [1490, 0], [1491, 1], [1492, 0], [1493, 1], [1494, 0], [1495, 1]]
        # Average query cost: 262.10592752021404

        # 10000query-steam.csv (time range: 0-1500)
        # 265.31126099269636 (Optimal)

        # 利用训练模型直接测试（不微调）
        # reward_threshold=0.1  |  reward>=0.1 or operation_cost==0:
        # steps: None
        # The total reward : -0.527105731941388
        # io_cost :  [119040, 5898.0, 192.0, 416.0, 384.0, 448.0, 448.0, 384.0, 416.0, 416.0, 416.0, 273111.0, 384.0, 160.0, 160.0, 256.0, 224.0, 224.0, 224.0, 256.0, 288.0, 288.0, 57145.0, 384.0, 31736.0, 41228.0, 352.0, 384.0, 416.0, 416.0, 416.0, 416.0, 416.0, 416.0, 416.0, 169163.0, 416.0, 224.0, 224.0, 256.0, 352.0, 416.0, 448.0, 320.0, 256.0, 160.0, 160.0, 160.0, 160.0, 298596.0, 160.0, 128.0, 128.0, 224.0, 224.0, 224.0, 160.0, 288.0, 256.0, 320.0, 192.0, 224.0, 224.0, 192.0, 401977.0, 192.0, 320.0, 320.0, 288.0, 320.0, 160.0, 128.0, 128.0, 128.0, 128.0, 429418.0, 128.0, 192.0, 416.0, 416.0, 320.0, 320.0, 320.0, 320.0, 320.0, 320.0, 33968.0, 320.0, 128.0, 160.0, 128.0, 128.0, 192.0, 192.0, 256.0, 256.0, 192.0, 192.0, 258468.0, 192.0, 256.0, 320.0, 320.0, 320.0, 320.0, 320.0, 256.0, 416.0, 384.0, 352.0, 175080.0, 352.0, 480.0, 416.0, 416.0, 384.0, 384.0, 384.0, 384.0, 384.0, 384.0, 146218.0, 384.0, 160.0, 192.0, 352.0, 416.0, 192.0, 288.0, 192.0, 192.0, 192.0, 293008.0, 192.0, 7020.0, 224.0, 288.0, 320.0, 320.0, 320.0, 320.0, 448.0, 544.0, 416.0, 118845.0, 416.0, 42841.0, 224.0, 256.0, 320.0, 320.0, 160.0, 160.0, 160.0, 160.0, 160.0, 176090.0, 160.0, 576.0, 448.0, 320.0, 256.0, 256.0, 192.0, 288.0, 288.0, 288.0, 274892.0, 288.0, 320.0, 320.0, 320.0, 320.0, 352.0, 224.0, 256.0, 384.0, 320.0, 224.0, 160.0, 128.0, 64.0, 245854.0, 64.0, 256.0, 352.0, 352.0, 352.0, 352.0, 352.0, 352.0, 352.0, 352.0, 352.0, 48653.0, 288.0, 416.0, 128.0, 192.0, 320.0, 320.0, 128.0, 128.0, 128.0, 256.0, 256.0, 192.0, 270778.0, 192.0, 320.0, 160.0, 320.0, 384.0, 224.0, 128.0, 224.0, 128.0, 224.0, 128.0, 377033.0, 128.0, 160.0, 288.0, 256.0, 256.0, 160.0, 160.0, 224.0, 160.0, 224.0, 361772.0, 256.0, 288.0, 384.0, 256.0, 320.0, 112113.0, 416.0, 416.0, 320.0, 320.0, 320.0, 320.0, 320.0, 320.0, 320.0, 320.0, 288.0, 54080.0, 128.0, 416.0, 352.0, 288.0, 320.0, 64.0, 64.0, 160.0, 192.0, 192.0, 192.0, 256291.0, 192.0, 320.0, 256.0, 256.0, 320.0, 160.0, 256.0, 256.0, 256.0, 256.0, 256.0, 290960.0, 256.0, 288.0, 320.0, 320.0, 320.0, 288.0, 288.0, 288.0, 160.0, 224.0, 295311.0, 224.0, 320.0, 320.0, 320.0, 352.0, 352.0, 416.0, 416.0, 384.0, 448.0, 288.0, 256.0, 320.0, 384.0, 384.0, 272944.0, 416.0, 416.0, 416.0, 416.0, 352.0, 288.0, 288.0, 288.0, 256.0, 288.0, 288.0, 384.0, 320.0, 288.0, 352.0, 352.0, 352.0, 289475.0, 352.0, 416.0, 384.0, 288.0, 288.0, 160.0, 288.0, 288.0, 192.0, 192.0, 128.0, 128.0, 234219.0, 128.0, 256.0, 480.0, 416.0, 352.0, 320.0, 256.0, 256.0, 256.0, 192.0, 192.0, 286814.0, 192.0, 320.0, 256.0, 256.0, 256.0, 416.0, 352.0, 352.0, 384.0, 384.0, 384.0, 192.0, 224.0, 128.0, 178911.0, 128.0, 192.0, 192.0, 128.0, 64.0, 128.0, 64.0, 128.0, 128.0, 128.0, 354866.0]
        # action list :  [[1504, 1], [1505, 1], [1506, 0], [1507, 0], [1508, 0], [1509, 0], [1510, 0], [1511, 0], [1512, 0], [1513, 0], [1514, 0], [1515, 0], [1517, 0], [1518, 0], [1519, 0], [1520, 0], [1521, 0], [1522, 0], [1523, 0], [1524, 0], [1525, 0], [1526, 0], [1527, 1], [1528, 1], [1530, 0], [1531, 0], [1532, 0], [1533, 0], [1534, 0], [1535, 0], [1536, 0], [1537, 0], [1538, 0], [1539, 0], [1541, 0], [1542, 0], [1543, 0], [1544, 0], [1545, 0], [1546, 0], [1547, 0], [1548, 0], [1553, 0], [1554, 0], [1555, 0], [1556, 0], [1557, 0], [1560, 0], [1561, 0], [1562, 0], [1563, 0], [1564, 0], [1565, 0], [1566, 0], [1567, 0], [1568, 0], [1569, 0], [1570, 0], [1571, 0], [1575, 0], [1589, 0], [1590, 0], [1598, 0], [1599, 0], [1606, 0], [1607, 0], [1608, 0], [1609, 0], [1610, 0], [1611, 0], [1612, 0], [1613, 0], [1614, 0], [1615, 0], [1616, 0], [1617, 0], [1618, 0], [1619, 0], [1620, 0], [1621, 0], [1622, 0], [1625, 0], [1626, 0], [1627, 0], [1628, 0], [1629, 0], [1630, 0], [1631, 0], [1632, 0], [1633, 0], [1634, 0], [1635, 0], [1636, 0], [1640, 0], [1641, 0], [1642, 0], [1643, 0], [1644, 0], [1645, 0], [1646, 0], [1647, 0], [1648, 0], [1649, 0], [1650, 0], [1651, 0], [1652, 0], [1653, 0], [1654, 0], [1655, 0], [1656, 0], [1657, 0], [1658, 0], [1659, 0], [1663, 0], [1664, 0], [1665, 0], [1669, 0], [1670, 0], [1671, 0], [1672, 0], [1673, 0], [1674, 0], [1675, 0], [1676, 1], [1678, 0], [1679, 0], [1680, 0], [1681, 0], [1682, 0], [1683, 0], [1684, 0], [1685, 0], [1686, 0], [1687, 0], [1688, 1], [1689, 0], [1690, 0], [1691, 0], [1692, 0], [1693, 0], [1694, 0], [1695, 0], [1696, 0], [1697, 0], [1698, 0], [1707, 0], [1708, 0], [1709, 0], [1710, 0], [1711, 0], [1712, 0], [1713, 0], [1714, 0], [1715, 0], [1716, 0], [1720, 0], [1721, 0], [1722, 0], [1723, 0], [1724, 0], [1725, 0], [1726, 0], [1727, 0], [1728, 0], [1729, 0], [1730, 0], [1731, 0], [1732, 0], [1733, 0], [1734, 0], [1736, 0], [1737, 0], [1738, 0], [1739, 0], [1740, 0], [1741, 0], [1742, 0], [1743, 0], [1744, 0], [1745, 0], [1746, 0], [1747, 0], [1748, 0], [1749, 0], [1750, 0], [1751, 0], [1752, 0], [1753, 0], [1754, 0], [1755, 0], [1756, 0], [1757, 0], [1758, 0], [1765, 0], [1767, 0], [1768, 0], [1769, 0], [1770, 0], [1771, 0], [1784, 0], [1785, 0], [1787, 0], [1788, 0], [1789, 0], [1790, 0], [1792, 0], [1793, 0], [1794, 0], [1795, 0], [1806, 0], [1807, 0], [1808, 0], [1809, 0], [1810, 0], [1811, 0], [1812, 0], [1813, 0], [1814, 1], [1815, 0], [1816, 0], [1817, 0], [1818, 0], [1819, 0], [1820, 0], [1821, 0], [1822, 0], [1823, 0], [1824, 0], [1825, 0], [1826, 0], [1827, 0], [1828, 0], [1829, 0], [1830, 0], [1831, 0], [1832, 0], [1833, 0], [1834, 0], [1835, 0], [1836, 0], [1837, 0], [1845, 0], [1846, 0], [1849, 0], [1850, 0], [1851, 0], [1852, 0], [1853, 0], [1854, 0], [1856, 0], [1857, 0], [1858, 0], [1867, 0], [1868, 0], [1869, 0], [1870, 0], [1871, 0], [1872, 0], [1873, 0], [1874, 0], [1875, 0], [1876, 0], [1880, 0], [1881, 0], [1882, 0], [1883, 0], [1884, 0], [1885, 0], [1886, 0], [1887, 0], [1888, 0], [1889, 0], [1890, 0], [1891, 0], [1892, 0], [1893, 0], [1894, 0], [1895, 0], [1896, 0], [1897, 0], [1898, 0], [1899, 0], [1900, 0], [1901, 0], [1902, 0], [1903, 0], [1907, 0], [1910, 0], [1911, 0], [1916, 0], [1917, 0], [1918, 0], [1919, 0], [1920, 0], [1923, 0], [1924, 0], [1925, 0], [1926, 0], [1927, 0], [1928, 0], [1929, 0], [1930, 0], [1931, 0], [1932, 0], [1933, 0], [1934, 0], [1935, 0], [1946, 0], [1947, 0], [1948, 0], [1949, 0], [1950, 0], [1952, 0], [1953, 0], [1954, 0], [1955, 0], [1956, 0], [1957, 0], [1960, 0], [1961, 0], [1962, 0], [1963, 0], [1964, 0], [1965, 0], [1966, 0], [1967, 0], [1968, 0], [1969, 0], [1970, 0], [1971, 0], [1972, 0], [1973, 0], [1991, 0], [1992, 0], [1993, 0], [1994, 0], [1995, 0], [1996, 0], [1997, 0], [1998, 0]]
        # Average query cost: 274.87047249962734
        # (289.8075)

        # 利用训练模型进行微调（微调的概念理解错了把，微调仍然是对数据已知）
        # reward_threshold=0.1  |  reward>=0.1 or operation_cost==0:
        # Steps: 1e4
        # The total reward : -1.5358069864281567
        # io_cost :  [119040, 5898.0, 416.0, 384.0, 448.0, 448.0, 384.0, 416.0, 416.0, 416.0, 384.0, 283911.0, 384.0, 96.0, 160.0, 256.0, 256.0, 256.0, 256.0, 320.0, 320.0, 416.0, 448.0, 112050.0, 320.0, 27135.0, 416.0, 256.0, 288.0, 288.0, 288.0, 288.0, 288.0, 288.0, 288.0, 139904.0, 288.0, 416.0, 416.0, 448.0, 512.0, 320.0, 256.0, 224.0, 224.0, 224.0, 224.0, 224.0, 224.0, 224.0, 289869.0, 224.0, 416.0, 416.0, 384.0, 384.0, 448.0, 480.0, 384.0, 192.0, 224.0, 224.0, 224.0, 256860.0, 224.0, 544.0, 544.0, 544.0, 544.0, 544.0, 544.0, 544.0, 544.0, 544.0, 36638.0, 448.0, 320.0, 384.0, 320.0, 288.0, 288.0, 288.0, 288.0, 288.0, 288.0, 288.0, 265096.0, 288.0, 352.0, 352.0, 352.0, 352.0, 288.0, 256.0, 128.0, 128.0, 224.0, 228402.0, 128.0, 288.0, 320.0, 320.0, 288.0, 416.0, 416.0, 416.0, 416.0, 416.0, 54227.0, 416.0, 256.0, 224.0, 128.0, 192.0, 192.0, 256.0, 256.0, 192.0, 192.0, 249777.0, 192.0, 416.0, 352.0, 352.0, 352.0, 352.0, 352.0, 288.0, 320.0, 288.0, 132886.0, 256.0, 256.0, 416.0, 384.0, 352.0, 352.0, 352.0, 352.0, 352.0, 352.0, 169652.0, 352.0, 352.0, 320.0, 448.0, 544.0, 448.0, 448.0, 416.0, 192.0, 288.0, 261770.0, 192.0, 416.0, 416.0, 480.0, 480.0, 544.0, 544.0, 512.0, 448.0, 448.0, 448.0, 448.0, 56658.0, 448.0, 448.0, 288.0, 192.0, 128.0, 128.0, 128.0, 128.0, 128.0, 128.0, 128.0, 294709.0, 128.0, 384.0, 416.0, 416.0, 416.0, 384.0, 384.0, 384.0, 384.0, 384.0, 302235.0, 352.0, 416.0, 448.0, 448.0, 352.0, 448.0, 416.0, 320.0, 224.0, 224.0, 224.0, 261724.0, 224.0, 288.0, 384.0, 384.0, 320.0, 320.0, 320.0, 320.0, 384.0, 384.0, 384.0, 288.0, 384.0, 256.0, 256.0, 192.0, 192.0, 268554.0, 192.0, 448.0, 416.0, 448.0, 448.0, 352.0, 352.0, 352.0, 352.0, 352.0, 60635.0, 288.0, 256.0, 352.0, 448.0, 480.0, 448.0, 416.0, 320.0, 416.0, 416.0, 384.0, 292504.0, 384.0, 416.0, 256.0, 256.0, 192.0, 192.0, 256.0, 256.0, 256.0, 256.0, 256.0, 256.0, 256.0, 256.0, 160.0, 132396.0, 224.0, 320.0, 224.0, 224.0, 224.0, 320.0, 320.0, 288.0, 320.0, 320.0, 339522.0, 320.0, 224.0, 224.0, 224.0, 224.0, 192.0, 192.0, 64.0, 64.0, 64.0, 121156.0, 416.0, 384.0, 288.0, 224.0, 224.0, 288.0, 256.0, 256.0, 352.0, 352.0, 256.0, 303520.0, 256.0, 416.0, 416.0, 416.0, 192.0, 320.0, 256.0, 384.0, 320.0, 224.0, 288.0, 352.0, 352.0, 352.0, 293582.0, 352.0, 416.0, 416.0, 416.0, 352.0, 352.0, 480.0, 480.0, 512.0, 384.0, 352.0, 384.0, 384.0, 384.0, 352.0, 225021.0, 352.0, 384.0, 256.0, 288.0, 384.0, 384.0, 384.0, 384.0, 384.0, 384.0, 77785.0, 384.0, 416.0, 480.0, 416.0, 448.0, 288.0, 320.0, 384.0, 384.0, 384.0, 416.0, 416.0, 279971.0, 416.0, 320.0, 256.0, 256.0, 256.0, 320.0, 352.0, 352.0, 416.0, 352.0, 320.0, 416.0, 384.0, 384.0, 384.0, 246990.0, 288.0, 416.0, 320.0, 320.0, 384.0, 448.0, 448.0, 448.0, 448.0, 448.0, 44976.0, 480.0, 320.0, 448.0, 352.0, 384.0, 416.0, 416.0, 320.0, 192.0, 192.0, 192.0, 259835.0, 192.0, 512.0, 512.0, 512.0, 448.0, 448.0, 448.0, 480.0, 480.0, 512.0, 58864.0, 448.0, 384.0, 288.0, 320.0, 288.0, 320.0, 320.0, 256.0, 256.0, 256.0, 228311.0, 256.0, 320.0, 320.0, 320.0, 480.0, 352.0, 352.0, 416.0, 416.0, 416.0, 224.0, 224.0, 224.0, 224.0, 211777.0, 224.0, 288.0, 288.0, 352.0, 352.0, 352.0, 352.0, 352.0, 352.0, 192.0, 37248.0, 192.0, 416.0, 448.0, 448.0, 544.0, 416.0, 448.0, 416.0, 256.0, 192.0, 256.0, 262623.0, 320.0, 416.0, 544.0, 480.0, 480.0, 33637.0]
        # action list :  [[1504, 1], [1505, 1], [1507, 0], [1508, 0], [1509, 0], [1510, 0], [1511, 0], [1512, 0], [1513, 0], [1514, 0], [1515, 0], [1516, 0], [1518, 0], [1519, 0], [1520, 0], [1521, 0], [1522, 0], [1523, 0], [1524, 0], [1525, 0], [1526, 0], [1527, 0], [1528, 0], [1529, 1], [1530, 0], [1531, 0], [1532, 0], [1533, 0], [1534, 0], [1535, 0], [1536, 0], [1537, 0], [1538, 0], [1539, 0], [1541, 0], [1542, 0], [1543, 0], [1544, 0], [1547, 0], [1548, 0], [1552, 0], [1553, 0], [1554, 0], [1555, 0], [1556, 0], [1557, 0], [1558, 0], [1559, 0], [1562, 0], [1563, 0], [1564, 0], [1565, 0], [1566, 0], [1567, 0], [1568, 0], [1569, 0], [1570, 0], [1571, 0], [1572, 0], [1573, 0], [1575, 0], [1576, 0], [1577, 0], [1578, 0], [1579, 0], [1580, 0], [1581, 0], [1582, 0], [1583, 0], [1584, 0], [1585, 0], [1587, 0], [1588, 0], [1591, 0], [1592, 0], [1593, 0], [1594, 0], [1595, 0], [1596, 0], [1597, 0], [1598, 0], [1601, 0], [1602, 0], [1603, 0], [1604, 0], [1605, 0], [1606, 0], [1607, 0], [1608, 0], [1609, 0], [1611, 0], [1613, 0], [1614, 0], [1615, 0], [1616, 0], [1617, 0], [1618, 0], [1619, 0], [1620, 0], [1621, 0], [1622, 0], [1626, 0], [1627, 0], [1628, 0], [1629, 0], [1630, 0], [1631, 0], [1632, 0], [1633, 0], [1634, 0], [1635, 0], [1636, 0], [1640, 0], [1641, 0], [1642, 0], [1643, 0], [1644, 0], [1645, 0], [1646, 0], [1647, 0], [1648, 0], [1649, 0], [1650, 0], [1651, 0], [1652, 0], [1653, 0], [1654, 0], [1655, 0], [1656, 0], [1657, 0], [1658, 0], [1663, 0], [1664, 0], [1665, 0], [1666, 0], [1667, 0], [1668, 0], [1669, 0], [1670, 0], [1671, 0], [1672, 0], [1673, 0], [1674, 0], [1675, 0], [1676, 0], [1677, 0], [1678, 0], [1679, 0], [1680, 0], [1681, 0], [1682, 0], [1683, 0], [1684, 0], [1685, 0], [1686, 0], [1689, 0], [1690, 0], [1691, 0], [1692, 0], [1693, 0], [1694, 0], [1695, 0], [1696, 0], [1697, 0], [1704, 0], [1709, 0], [1710, 0], [1711, 0], [1712, 0], [1713, 0], [1714, 0], [1715, 0], [1716, 0], [1717, 0], [1724, 0], [1725, 0], [1726, 0], [1727, 0], [1728, 0], [1729, 0], [1730, 0], [1731, 0], [1732, 0], [1733, 0], [1734, 0], [1735, 0], [1736, 0], [1737, 0], [1738, 0], [1739, 0], [1740, 0], [1741, 0], [1742, 0], [1743, 0], [1744, 0], [1745, 0], [1746, 0], [1747, 0], [1748, 0], [1751, 0], [1752, 0], [1753, 0], [1754, 0], [1755, 0], [1756, 0], [1757, 0], [1758, 0], [1759, 0], [1760, 0], [1761, 0], [1762, 0], [1763, 0], [1764, 0], [1765, 0], [1766, 0], [1767, 0], [1768, 0], [1769, 0], [1770, 0], [1771, 0], [1772, 0], [1773, 0], [1774, 0], [1775, 0], [1776, 0], [1777, 0], [1778, 0], [1779, 0], [1780, 0], [1781, 0], [1782, 0], [1783, 0], [1784, 0], [1785, 0], [1786, 0], [1787, 0], [1788, 0], [1789, 0], [1790, 0], [1791, 0], [1792, 0], [1793, 0], [1794, 0], [1795, 0], [1807, 0], [1808, 0], [1809, 0], [1810, 0], [1811, 0], [1812, 0], [1813, 0], [1814, 0], [1815, 0], [1816, 0], [1817, 0], [1818, 0], [1819, 0], [1820, 1], [1824, 0], [1825, 0], [1826, 0], [1827, 0], [1828, 0], [1830, 0], [1831, 0], [1832, 0], [1834, 0], [1835, 0], [1836, 0], [1837, 0], [1841, 0], [1842, 0], [1843, 0], [1844, 0], [1845, 0], [1846, 0], [1847, 0], [1848, 0], [1849, 0], [1850, 0], [1851, 0], [1852, 0], [1853, 0], [1855, 0], [1858, 0], [1859, 0], [1860, 0], [1861, 0], [1862, 0], [1863, 0], [1864, 0], [1865, 0], [1866, 0], [1867, 0], [1868, 0], [1869, 0], [1870, 0], [1871, 0], [1872, 0], [1873, 0], [1874, 0], [1875, 0], [1876, 0], [1878, 0], [1879, 0], [1880, 0], [1881, 0], [1882, 0], [1883, 0], [1884, 0], [1885, 0], [1886, 0], [1888, 0], [1889, 0], [1890, 0], [1891, 0], [1892, 0], [1893, 0], [1894, 0], [1895, 0], [1896, 0], [1898, 0], [1899, 0], [1900, 0], [1901, 0], [1902, 0], [1903, 0], [1904, 0], [1905, 0], [1906, 0], [1907, 0], [1908, 0], [1909, 0], [1910, 0], [1911, 0], [1912, 0], [1914, 0], [1915, 0], [1916, 0], [1917, 0], [1918, 0], [1919, 0], [1920, 0], [1921, 0], [1922, 0], [1923, 0], [1924, 0], [1926, 0], [1927, 0], [1928, 0], [1929, 0], [1930, 0], [1931, 0], [1932, 0], [1933, 0], [1934, 0], [1935, 0], [1937, 0], [1938, 0], [1939, 0], [1940, 0], [1941, 0], [1942, 0], [1943, 0], [1944, 0], [1945, 0], [1946, 0], [1947, 0], [1948, 0], [1949, 0], [1951, 0], [1952, 0], [1953, 0], [1954, 0], [1955, 0], [1956, 0], [1957, 0], [1960, 0], [1961, 0], [1962, 0], [1963, 0], [1964, 0], [1965, 0], [1966, 0], [1967, 0], [1968, 0], [1969, 0], [1970, 0], [1971, 0], [1972, 0], [1973, 0], [1974, 0], [1975, 0], [1976, 0], [1977, 0], [1978, 0], [1979, 0], [1980, 0], [1981, 0], [1982, 0], [1983, 0], [1984, 0], [1985, 0], [1986, 0], [1987, 0], [1988, 0], [1989, 0], [1990, 0], [1991, 0], [1992, 0], [1993, 0], [1994, 0], [1995, 0], [1996, 0], [1997, 0], [1998, 0]]
        # Average query cost: 278.2287971381726
        # 299.2328215829483（变差了，是不是load之后，再learn会改变原有的模型参数）

if __name__=="__main__":
    PpoControllerV3().repartition(None,None)
